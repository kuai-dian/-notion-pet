{"version":3,"file":"select.js","sources":["../../src/select/select.tsx"],"sourcesContent":["import { defineComponent, nextTick, VNode, ComponentPublicInstance } from 'vue';\nimport isFunction from 'lodash/isFunction';\nimport debounce from 'lodash/debounce';\nimport get from 'lodash/get';\nimport set from 'lodash/set';\nimport { CloseCircleFilledIcon } from 'tdesign-icons-vue-next';\nimport TLoading from '../loading';\n\nimport { renderTNodeJSX } from '../utils/render-tnode';\nimport mixins from '../utils/mixins';\nimport getConfigReceiverMixins, { SelectConfig } from '../config-provider/config-receiver';\nimport { prefix } from '../config';\nimport CLASSNAMES from '../utils/classnames';\nimport TInput from '../input/index';\nimport Tag from '../tag/index';\nimport FakeArrow from '../common-components/fake-arrow';\nimport Popup, { PopupProps } from '../popup/index';\nimport Option from './option';\n\nimport props from './props';\nimport { SelectOption, TdOptionProps, SelectValue, TdSelectProps, SelectOptionGroup } from './type';\nimport { ClassName } from '../common';\nimport { emitEvent } from '../utils/event';\n\nexport type OptionInstance = InstanceType<typeof Option>;\n\ninterface KeysType {\n  value?: string;\n  label?: string;\n}\n\nconst name = `${prefix}-select`;\n// trigger元素不超过此宽度时，下拉选项的最大宽度（用户未设置overStyle width时）\n// 用户设置overStyle width时，以设置的为准\nconst DEFAULT_MAX_OVERLAY_WIDTH = 500;\n// 默认垂直滚动条宽度 .narrow-scrollbar 8px\nconst DEFAULT_SCROLLY_WIDTH = 8;\n\nexport default defineComponent({\n  ...mixins(getConfigReceiverMixins<SelectConfig>('select')),\n  name: 'TSelect',\n  components: {\n    CloseCircleFilledIcon,\n    TInput,\n    Tag,\n    Popup,\n    TOption: Option,\n  },\n  provide(): any {\n    return {\n      tSelect: this,\n    };\n  },\n  props: { ...props },\n  emits: [\n    'change',\n    'input',\n    'clear',\n    'keydown',\n    'keyup',\n    'keypress',\n    'focus',\n    'blur',\n    'remove',\n    'create',\n    'search',\n    'visible-change',\n  ],\n  data() {\n    return {\n      isHover: false,\n      visible: false,\n      searchInput: '',\n      showCreateOption: false,\n      hasOptions: false, // select的slot是否有options组件\n      defaultProps: {\n        trigger: 'click',\n        placement: 'bottom-left' as string,\n        overlayClassName: '' as ClassName,\n        overlayStyle: {},\n      } as PopupProps,\n      focusing: false, // filterable时，输入框是否在focus中\n      labelInValue: this.valueType === 'object',\n      realValue: this.keys && (this.keys as KeysType).value ? (this.keys as KeysType).value : 'value',\n      realLabel: this.keys && (this.keys as KeysType).label ? (this.keys as KeysType).label : 'label',\n      realOptions: [] as Array<TdOptionProps>,\n      hoverIndex: -1,\n      popupOpenTime: 250, // popup打开弹出层的延迟时间\n      checkScroll: true, // 弹出层执行加宽事件（仅执行一次，且在有滚动条时执行）\n    };\n  },\n  computed: {\n    classes(): ClassName {\n      return [\n        `${name}`,\n        {\n          [CLASSNAMES.STATUS.disabled]: this.disabled,\n          [CLASSNAMES.STATUS.active]: this.visible,\n          [CLASSNAMES.SIZE[this.size]]: this.size,\n          [`${prefix}-has-prefix`]: this.$slots.prefixIcon,\n          [`${prefix}-no-border`]: !this.bordered,\n        },\n      ];\n    },\n    popClass(): string {\n      const { popupObject } = this;\n      return `${popupObject.overlayClassName} ${name}__dropdown narrow-scrollbar`;\n    },\n    tipsClass(): ClassName {\n      return [\n        `${name}__loading-tips`,\n        {\n          [CLASSNAMES.SIZE[this.size]]: this.size,\n        },\n      ];\n    },\n    emptyClass(): ClassName {\n      return [\n        `${name}__empty`,\n        {\n          [CLASSNAMES.SIZE[this.size]]: this.size,\n        },\n      ];\n    },\n    showPlaceholder(): boolean {\n      if (\n        !this.showFilter &&\n        ((!this.multiple && !this.selectedSingle) ||\n          (!this.multiple && typeof this.value === 'object' && !this.selectedSingle) ||\n          (Array.isArray(this.value) && !this.value.length) ||\n          this.value === null ||\n          this.value === undefined ||\n          this.value === '')\n      ) {\n        return true;\n      }\n      return false;\n    },\n    // 是否为分组选择器\n    isGroupOption(): boolean {\n      const firstOption = this.options?.[0];\n      return !!(firstOption && 'group' in firstOption && 'children' in firstOption);\n    },\n    filterPlaceholder(): string {\n      if (this.multiple && Array.isArray(this.value) && this.value.length) {\n        return '';\n      }\n      if (!this.multiple && this.selectedSingle) {\n        return this.selectedSingle;\n      }\n      return this.placeholder;\n    },\n    showClose(): boolean {\n      return Boolean(\n        this.clearable &&\n          this.isHover &&\n          !this.disabled &&\n          ((!this.multiple && (this.value || this.value === 0)) ||\n            (this.multiple && Array.isArray(this.value) && this.value.length)),\n      );\n    },\n    showArrow(): boolean {\n      return (\n        !this.clearable ||\n        !this.isHover ||\n        this.disabled ||\n        (!this.multiple && !this.value && this.value !== 0) ||\n        (this.multiple && (!Array.isArray(this.value) || (Array.isArray(this.value) && !this.value.length)))\n      );\n    },\n    canFilter(): boolean {\n      return this.filterable || isFunction(this.filter);\n    },\n    showLoading(): boolean {\n      return this.loading && !this.disabled;\n    },\n    showFilter(): boolean {\n      if (this.disabled) return false;\n      if (!this.multiple && this.selectedSingle && this.canFilter) {\n        return this.visible;\n      }\n      return this.canFilter;\n    },\n    selectedSingle(): string {\n      if (!this.multiple && (typeof this.value === 'string' || typeof this.value === 'number')) {\n        let target: Array<TdOptionProps> = [];\n        if (this.realOptions && this.realOptions.length) {\n          target = this.realOptions.filter((item) => get(item, this.realValue) === this.value);\n        }\n        if (target.length) {\n          if (get(target[target.length - 1], this.realLabel) === '') {\n            return get(target[target.length - 1], this.realValue);\n          }\n          return get(target[target.length - 1], this.realLabel);\n        }\n        return this.value.toString();\n      }\n      const showText = get(this.value, this.realLabel);\n      // label为空时显示value值\n      if (!this.multiple && typeof this.value === 'object' && showText !== undefined) {\n        return showText === '' ? get(this.value, this.realValue) : showText;\n      }\n      return '';\n    },\n    selectedMultiple(): Array<TdOptionProps> {\n      if (this.multiple && Array.isArray(this.value) && this.value.length) {\n        return this.value.map((item: string | number | TdOptionProps) => {\n          if (typeof item === 'object') {\n            return item;\n          }\n          const tmp = this.realOptions.filter((op) => get(op, this.realValue) === item);\n          const valueLabel = {};\n          set(valueLabel, this.realValue, item);\n          set(valueLabel, this.realLabel, tmp.length ? get(tmp[tmp.length - 1], this.realLabel) : item);\n          return tmp.length && tmp[tmp.length - 1].disabled ? { ...valueLabel, disabled: true } : valueLabel;\n        });\n      }\n      return [];\n    },\n    popupObject(): PopupProps {\n      const propsObject = this.popupProps ? { ...this.defaultProps, ...(this.popupProps as any) } : this.defaultProps;\n      return propsObject;\n    },\n    filterOptions(): Array<TdOptionProps> {\n      // filter优先级 filter方法>仅filterable\n      if (isFunction(this.filter)) {\n        return this.realOptions.filter((option) => this.filter(this.searchInput, option));\n      }\n      if (this.filterable) {\n        // 仅有filterable属性时，默认不区分大小写过滤label\n        return this.realOptions.filter(\n          (option) =>\n            option[this.realLabel].toString().toLowerCase().indexOf(this.searchInput.toString().toLowerCase()) !== -1,\n        );\n      }\n      return [];\n    },\n    displayOptions(): Array<TdOptionProps> {\n      // 展示优先级，用户远程搜索传入>组件通过filter过滤>getOptions后的完整数据\n      if (isFunction(this.onSearch) || this.$attrs.search) {\n        return this.realOptions;\n      }\n      if (this.canFilter && !this.creatable) {\n        if (this.searchInput === '') {\n          return this.realOptions;\n        }\n        return this.filterOptions;\n      }\n      return this.realOptions;\n    },\n    displayOptionsMap(): Map<TdOptionProps, boolean> {\n      const map = new Map();\n      this.displayOptions.forEach((item) => {\n        map.set(item, true);\n      });\n      return map;\n    },\n    hoverOptions(): Array<TdOptionProps> {\n      if (!this.showCreateOption) {\n        if (isFunction(this.filter) || this.filterable) {\n          return this.filterOptions;\n        }\n        return this.realOptions;\n      }\n      const willCreateOption = [{ value: this.searchInput, label: this.searchInput }] as Array<TdOptionProps>;\n      if (isFunction(this.filter) || this.filterable) {\n        return willCreateOption.concat(this.filterOptions);\n      }\n      return willCreateOption.concat(this.realOptions);\n    },\n  },\n  watch: {\n    showFilter(val) {\n      if (val && this.selectedSingle) {\n        nextTick(() => {\n          this.doFocus();\n        });\n      }\n    },\n    searchInput(val) {\n      if (!val && !this.visible) return;\n      if (isFunction(this.onSearch) || this.$attrs.search) {\n        this.debounceOnRemote();\n      }\n      if (this.canFilter && val && this.creatable) {\n        const tmp = this.realOptions.filter((item) => get(item, this.realLabel).toString() === val);\n        this.showCreateOption = !tmp.length;\n      } else {\n        this.showCreateOption = false;\n      }\n    },\n    options: {\n      immediate: true,\n      deep: true,\n      handler(options: SelectOption[]) {\n        if (Array.isArray(options)) {\n          this.realOptions = this.getRealOptions(options);\n        } else {\n          console.error('TDesign Select: options must be an array.');\n        }\n      },\n    },\n    visible() {\n      this.visible && document.addEventListener('keydown', this.keydownEvent);\n      !this.visible && document.removeEventListener('keydown', this.keydownEvent);\n    },\n  },\n  mounted() {\n    this.checkVal();\n  },\n  methods: {\n    getRealOptions(options: SelectOption[]): Array<TdOptionProps> {\n      if (this.isGroupOption) {\n        let arr: TdOptionProps[] = [];\n        options.forEach((item) => {\n          if ('children' in item) {\n            arr = arr.concat(item.children);\n          }\n        });\n        return arr;\n      }\n      return [...options];\n    },\n    checkVal() {\n      const { value, multiple } = this;\n      if ((multiple && !Array.isArray(value)) || (!multiple && Array.isArray(value))) {\n        emitEvent(this, 'change', this.multiple ? [] : '');\n        console.warn('TDesign Warn:', 'select props value invalid, v-model automatic calibration');\n      }\n    },\n    multiLimitDisabled(value: string | number) {\n      if (this.multiple && this.max) {\n        if (this.value instanceof Array && this.value.indexOf(value) === -1 && this.max <= this.value.length) {\n          return true;\n        }\n      }\n      return false;\n    },\n    visibleChange(val: boolean) {\n      emitEvent<Parameters<TdSelectProps['onVisibleChange']>>(this, 'visible-change', val);\n      this.visible = val;\n      if (!val) {\n        this.searchInput = '';\n      }\n      val && this.monitorWidth();\n      val && this.canFilter && this.doFocus();\n    },\n    onOptionClick(value: string | number, e: MouseEvent | KeyboardEvent) {\n      if (this.value !== value) {\n        if (this.multiple && this.value instanceof Array) {\n          if (this.labelInValue) {\n            const index = this.value.map((item) => get(item, this.realValue)).indexOf(value);\n            if (index > -1) {\n              this.removeTag(index, { e });\n            } else {\n              this.value.push(this.realOptions.filter((item) => get(item, this.realValue) === value)[0]);\n              this.emitChange(this.value);\n            }\n          } else {\n            const index = this.value.indexOf(value);\n            if (index > -1) {\n              this.removeTag(index, { e });\n            } else {\n              this.value.push(value);\n              this.emitChange(this.value);\n            }\n          }\n        } else {\n          this.emitChange(value);\n        }\n      }\n      if (!this.multiple) {\n        this.searchInput = '';\n        this.hideMenu();\n      } else {\n        if (!this.reserveKeyword) {\n          this.searchInput = '';\n        }\n        this.canFilter && this.doFocus();\n      }\n    },\n    removeTag(index: number, context?: { e?: MouseEvent | KeyboardEvent }) {\n      const { e } = context || {};\n      e && e.stopPropagation();\n      if (this.disabled) {\n        return;\n      }\n      const val = this.value[index];\n      const removeOption = this.realOptions.filter((item) => get(item, this.realValue) === val);\n      const tempValue = this.value instanceof Array ? [].concat(this.value) : [];\n      tempValue.splice(index, 1);\n      this.emitChange(tempValue);\n      emitEvent(this, 'remove', { value: val, data: removeOption[0], e });\n    },\n    hideMenu() {\n      this.visible = false;\n    },\n    clearSelect(e: MouseEvent) {\n      e.stopPropagation();\n      if (this.multiple) {\n        this.emitChange([]);\n      } else {\n        this.emitChange('');\n      }\n      this.focusing = false;\n      this.searchInput = '';\n      this.visible = false;\n      emitEvent(this, 'clear', { e });\n    },\n    getOptions(option: OptionInstance) {\n      // create option值不push到options里\n      if (option.$el && option.$el.className && option.$el.className.indexOf(`${name}__create-option--special`) !== -1)\n        return;\n      const tmp = this.realOptions.filter((item) => get(item, this.realValue) === option.value);\n      if (!tmp.length) {\n        this.hasOptions = true;\n        const valueLabel = {};\n        set(valueLabel, this.realValue, option.value);\n        set(valueLabel, this.realLabel, option.label);\n        const valueLabelAble = option.disabled ? { ...valueLabel, disabled: true } : valueLabel;\n        this.realOptions.push(valueLabelAble);\n      }\n    },\n    destroyOptions(option: OptionInstance) {\n      this.realOptions.forEach((item, index) => {\n        if (item[this.realValue] === option.value && item[this.realLabel] === option.label) {\n          this.realOptions.splice(index, 1);\n        }\n      });\n    },\n    emitChange(val: SelectValue | Array<SelectValue>) {\n      let value: SelectValue | Array<SelectValue> | Array<TdOptionProps> | TdOptionProps;\n      if (this.labelInValue) {\n        if (Array.isArray(val)) {\n          if (!val.length) {\n            value = [];\n          } else {\n            value = val;\n          }\n        } else {\n          const target = this.realOptions.filter((item) => get(item, this.realValue) === val);\n          value = target.length ? target[0] : '';\n        }\n      } else {\n        value = val;\n      }\n      emitEvent<Parameters<TdSelectProps['onChange']>>(this, 'change', value);\n    },\n    createOption(value: string) {\n      emitEvent<Parameters<TdSelectProps['onCreate']>>(this, 'create', value);\n    },\n    debounceOnRemote: debounce(function (this: any) {\n      emitEvent<Parameters<TdSelectProps['onSearch']>>(this, 'search', this.searchInput);\n    }, 300),\n    focus(value: string, context: { e: FocusEvent }) {\n      this.focusing = true;\n      emitEvent<Parameters<TdSelectProps['onFocus']>>(this, 'focus', { value: this.value, e: context?.e });\n    },\n    blur(value: string, context: { e: FocusEvent | KeyboardEvent }) {\n      this.focusing = false;\n      emitEvent<Parameters<TdSelectProps['onBlur']>>(this, 'blur', { value: this.value, e: context?.e });\n    },\n    enter(value: string, context: { e: KeyboardEvent }) {\n      emitEvent<Parameters<TdSelectProps['onEnter']>>(this, 'enter', {\n        inputValue: this.searchInput,\n        value: this.value,\n        e: context?.e,\n      });\n    },\n    keydownEvent(e: KeyboardEvent) {\n      if (!this.hoverOptions.length) return;\n      const preventKeys = ['ArrowDown', 'ArrowUp', 'Enter', 'Escape', 'Tab'];\n      if (preventKeys.includes(e.code)) {\n        e.preventDefault();\n      }\n      switch (e.code) {\n        case 'ArrowDown':\n          if (this.hoverIndex === -1) {\n            this.initHoverindex();\n            return;\n          }\n          if (this.hoverIndex < this.hoverOptions.length - 1) {\n            this.hoverIndex += 1;\n            this.arrowDownOption();\n          } else {\n            this.hoverIndex = 0;\n            this.arrowDownOption();\n          }\n          break;\n        case 'ArrowUp':\n          if (this.hoverIndex === -1) {\n            this.initHoverindex();\n            return;\n          }\n          if (this.hoverIndex > 0) {\n            this.hoverIndex -= 1;\n            this.arrowUpOption();\n          } else {\n            this.hoverIndex = this.hoverOptions.length - 1;\n            this.arrowUpOption();\n          }\n          break;\n        case 'Enter':\n          if (this.hoverIndex === -1) return;\n          if (this.showCreateOption && this.hoverIndex === 0) {\n            this.createOption(this.searchInput);\n          }\n          this.hoverOptions[this.hoverIndex] &&\n            this.onOptionClick(this.hoverOptions[this.hoverIndex][this.realValue], e);\n          break;\n        case 'Escape':\n        case 'Tab':\n          this.visible = false;\n          emitEvent<Parameters<TdSelectProps['onVisibleChange']>>(this, 'visible-change', false);\n          this.searchInput = '';\n          if (this.focusing) {\n            this.blur(this.searchInput, { e });\n          }\n          break;\n      }\n    },\n    arrowDownOption() {\n      let count = 0;\n      while (this.hoverIndex < this.hoverOptions.length) {\n        if (!this.hoverOptions[this.hoverIndex] || !this.hoverOptions[this.hoverIndex].disabled) {\n          break;\n        }\n        if (this.hoverIndex === this.hoverOptions.length - 1) {\n          this.hoverIndex = 0;\n        } else {\n          this.hoverIndex += 1;\n        }\n        count += 1;\n        if (count >= this.hoverOptions.length) break;\n      }\n    },\n    arrowUpOption() {\n      let count = 0;\n      while (this.hoverIndex > -1) {\n        if (!this.hoverOptions[this.hoverIndex] || !this.hoverOptions[this.hoverIndex].disabled) {\n          break;\n        }\n        if (this.hoverIndex === 0) {\n          this.hoverIndex = this.hoverOptions.length - 1;\n        } else {\n          this.hoverIndex -= 1;\n        }\n        count += 1;\n        if (count >= this.hoverOptions.length) break;\n      }\n    },\n    hoverEvent(v: boolean) {\n      this.isHover = v;\n    },\n    getOverlayElm(): HTMLElement {\n      let r;\n      try {\n        r = (this.$refs.popup as any).$refs.overlay || (this.$refs.popup as any).$refs.component.$refs.overlay;\n      } catch (e) {\n        console.warn('TDesign Warn:', e);\n      }\n      return r;\n    },\n    // 打开浮层时，监听trigger元素和浮层宽度，取max\n    monitorWidth() {\n      this.$nextTick(() => {\n        let styles = (this.popupProps && (this.popupProps as PopupProps).overlayStyle) || {};\n        if (this.popupProps && isFunction((this.popupProps as PopupProps).overlayStyle)) {\n          styles = (this.popupProps as any).overlayStyle(this.$refs.select as HTMLElement) || {};\n        }\n        if (typeof styles === 'object' && !styles.width) {\n          const elWidth = (this.$refs.select as HTMLElement).getBoundingClientRect().width;\n          const popupWidth = this.getOverlayElm().getBoundingClientRect().width;\n          const width =\n            elWidth > DEFAULT_MAX_OVERLAY_WIDTH\n              ? elWidth\n              : Math.min(DEFAULT_MAX_OVERLAY_WIDTH, Math.max(elWidth, popupWidth));\n          this.defaultProps.overlayStyle = { width: `${Math.ceil(width)}px` };\n          if (this.checkScroll) {\n            const timer = setTimeout(() => {\n              const { scrollHeight, clientHeight } = this.getOverlayElm();\n              if (scrollHeight > clientHeight) {\n                this.defaultProps.overlayStyle = { width: `${Math.ceil(width) + DEFAULT_SCROLLY_WIDTH}px` };\n              }\n              this.checkScroll = false;\n              clearTimeout(timer);\n            }, this.popupOpenTime);\n          }\n        }\n      });\n    },\n    getEmpty() {\n      const useLocale = !this.empty && !this.$slots.empty;\n      return useLocale ? this.t(this.global.empty) : renderTNodeJSX(this as ComponentPublicInstance, 'empty');\n    },\n    getLoadingText() {\n      const useLocale = !this.loadingText && !this.$slots.loadingText;\n      return useLocale\n        ? this.t(this.global.loadingText)\n        : renderTNodeJSX(this as ComponentPublicInstance, 'loadingText');\n    },\n    getPlaceholderText() {\n      return this.placeholder || this.t(this.global.placeholder);\n    },\n    getCloseIcon() {\n      const closeIconClass = [`${name}__right-icon`, `${name}__right-icon-clear`];\n      if (isFunction(this.global.clearIcon)) {\n        return (\n          <span class={closeIconClass} onClick={this.clearSelect}>\n            {this.global.clearIcon()}\n          </span>\n        );\n      }\n      return (\n        <close-circle-filled-icon\n          class={closeIconClass}\n          size={this.size}\n          onClick={({ e }: { e: MouseEvent }) => this.clearSelect(e)}\n        />\n      );\n    },\n    doFocus() {\n      const input = this.$refs.input as HTMLElement;\n      input?.focus();\n      this.focusing = true;\n    },\n    renderGroupOptions(options: SelectOptionGroup[]) {\n      return (\n        <ul>\n          {options.map((groupList: SelectOptionGroup) => {\n            const children = groupList.children.filter((item) => this.displayOptionsMap.get(item));\n            return (\n              <t-option-group label={groupList.group} divider={groupList.divider}>\n                {this.renderOptions(children)}\n              </t-option-group>\n            );\n          })}\n        </ul>\n      );\n    },\n    // options 直传时\n    renderOptions(options: SelectOption[]) {\n      return (\n        <ul>\n          {options.map((item: TdOptionProps, index: number) => (\n            <t-option\n              value={get(item, this.realValue)}\n              label={get(item, this.realLabel)}\n              content={item.content}\n              disabled={item.disabled || this.multiLimitDisabled(get(item, this.realValue))}\n              key={index}\n            ></t-option>\n          ))}\n        </ul>\n      );\n    },\n    // 两类：普通选择器和分组选择器\n    renderDataWithOptions() {\n      return this.isGroupOption\n        ? this.renderGroupOptions(this.options as SelectOptionGroup[])\n        : this.renderOptions(this.displayOptions);\n    },\n    initHoverindex() {\n      if (!this.multiple && (typeof this.value === 'string' || typeof this.value === 'number')) {\n        const targetIndex = Object.keys(this.hoverOptions).filter(\n          (i) => get(this.hoverOptions[i], this.realValue) === this.value,\n        );\n        this.hoverIndex = targetIndex.length ? parseInt(targetIndex[targetIndex.length - 1], 10) : -1;\n      } else if (this.multiple && Array.isArray(this.value) && this.value.length) {\n        this.value.some((item: string | number | TdOptionProps) => {\n          const targetIndex = Object.keys(this.hoverOptions).filter(\n            (i) =>\n              (typeof item === 'object' && get(this.hoverOptions[i], this.realValue) === get(item, this.realValue)) ||\n              get(this.hoverOptions[i], this.realValue) === item,\n          );\n          this.hoverIndex = targetIndex.length ? parseInt(targetIndex[targetIndex.length - 1], 10) : -1;\n          return this.hoverIndex !== -1;\n        });\n      }\n    },\n  },\n  render(): VNode {\n    const {\n      classes,\n      popupObject,\n      disabled,\n      popClass,\n      size,\n      showPlaceholder,\n      selectedMultiple,\n      multiple,\n      showFilter,\n      selectedSingle,\n      filterPlaceholder,\n      tipsClass,\n      loading,\n      loadingText,\n      emptyClass,\n      hasOptions,\n      realLabel,\n      showCreateOption,\n      displayOptions,\n    } = this;\n    const children = renderTNodeJSX(this, 'default');\n    const prefixIconSlot = renderTNodeJSX(this, 'prefixIcon');\n    const emptySlot = this.getEmpty();\n    const loadingTextSlot = this.getLoadingText();\n    const placeholderText = this.getPlaceholderText();\n    const slots = {\n      content: () => (\n        <div className={`${prefix}-select__dropdown-inner`}>\n          {renderTNodeJSX(this, 'panelTopContent')}\n          <ul v-show={showCreateOption} class={`${name}__create-option`}>\n            <t-option value={this.searchInput} label={this.searchInput} class={`${name}__create-option--special`} />\n          </ul>\n          {loading && <div class={tipsClass}>{loadingTextSlot || loadingText}</div>}\n          {!loading && !displayOptions.length && !showCreateOption && <li class={emptyClass}>{emptySlot}</li>}\n          {!hasOptions && displayOptions.length && !loading ? (\n            this.renderDataWithOptions()\n          ) : (\n            <ul class={`${prefix}-select__groups`}>{children}</ul>\n          )}\n          {renderTNodeJSX(this, 'panelBottomContent')}\n        </div>\n      ),\n    };\n    return (\n      <div ref=\"select\" class={`${name}__wrap`}>\n        <Popup\n          ref=\"popup\"\n          class={`${name}__popup-reference`}\n          visible={this.visible}\n          placement={popupObject.placement}\n          trigger={popupObject.trigger}\n          disabled={disabled}\n          overlayClassName={popClass}\n          overlayStyle={popupObject.overlayStyle}\n          onVisibleChange={this.visibleChange}\n          expandAnimation={true}\n          v-slots={slots}\n        >\n          <div\n            class={classes}\n            onMouseenter={this.hoverEvent.bind(null, true)}\n            onMouseleave={this.hoverEvent.bind(null, false)}\n          >\n            {prefixIconSlot && <span class=\"t-select__left-icon\">{prefixIconSlot[0]}</span>}\n            {showPlaceholder && <span class={`${name}__placeholder`}> {placeholderText}</span>}\n            {this.valueDisplay || this.$slots.valueDisplay\n              ? renderTNodeJSX(this, 'valueDisplay', {\n                  params: { value: selectedMultiple, onClose: (index: number) => this.removeTag(index) },\n                })\n              : selectedMultiple.map((item: TdOptionProps, index: number) => (\n                  <tag\n                    v-show={this.minCollapsedNum <= 0 || index < this.minCollapsedNum}\n                    key={index}\n                    size={size}\n                    closable={!item.disabled && !disabled}\n                    disabled={disabled}\n                    style=\"max-width: 100%;\"\n                    maxWidth=\"100%\"\n                    title={get(item, realLabel)}\n                    onClose={this.removeTag.bind(null, index)}\n                  >\n                    {get(item, realLabel)}\n                  </tag>\n                ))}\n            {this.collapsedItems || this.$slots.collapsedItems ? (\n              renderTNodeJSX(this, 'collapsedItems', {\n                params: {\n                  value: selectedMultiple,\n                  collapsedSelectedItems: selectedMultiple.slice(this.minCollapsedNum),\n                  count: selectedMultiple.length - this.minCollapsedNum,\n                },\n              })\n            ) : (\n              <tag v-show={this.minCollapsedNum > 0 && selectedMultiple.length > this.minCollapsedNum} size={size}>\n                {`+${selectedMultiple.length - this.minCollapsedNum}`}\n              </tag>\n            )}\n            {!multiple && !showPlaceholder && !showFilter && (\n              <span title={selectedSingle} class={`${name}__single`}>\n                {selectedSingle}\n              </span>\n            )}\n            {showFilter && (\n              <t-input\n                ref=\"input\"\n                v-model={this.searchInput}\n                size={size}\n                placeholder={filterPlaceholder}\n                disabled={disabled}\n                class={`${name}__input`}\n                readonly={!this.visible || !this.showFilter}\n                onFocus={this.focus}\n                onBlur={this.blur}\n                onEnter={this.enter}\n              />\n            )}\n            {this.showArrow && !this.showLoading && (\n              <FakeArrow overlayClassName={`${name}__right-icon`} isActive={this.visible && !this.disabled} />\n            )}\n            {this.showClose && !this.showLoading && this.getCloseIcon()}\n            {this.showLoading && <TLoading class={`${name}__right-icon ${name}__active-icon`} size=\"small\" />}\n          </div>\n        </Popup>\n      </div>\n    );\n  },\n});\n"],"names":["name","prefix","DEFAULT_MAX_OVERLAY_WIDTH","DEFAULT_SCROLLY_WIDTH","defineComponent","mixins","getConfigReceiverMixins","components","CloseCircleFilledIcon","TInput","Tag","Popup","TOption","Option","provide","tSelect","props","emits","data","isHover","visible","searchInput","showCreateOption","hasOptions","defaultProps","trigger","placement","overlayClassName","overlayStyle","focusing","labelInValue","valueType","realValue","keys","value","realLabel","label","realOptions","hoverIndex","popupOpenTime","checkScroll","computed","classes","CLASSNAMES","STATUS","disabled","active","SIZE","size","$slots","prefixIcon","bordered","popClass","popupObject","tipsClass","emptyClass","showPlaceholder","showFilter","multiple","selectedSingle","_typeof","Array","isArray","length","isGroupOption","firstOption","options","filterPlaceholder","placeholder","showClose","Boolean","clearable","showArrow","canFilter","filterable","isFunction","filter","showLoading","loading","target","item","get","toString","showText","selectedMultiple","map","tmp","op","valueLabel","set","propsObject","popupProps","filterOptions","option","toLowerCase","indexOf","displayOptions","onSearch","$attrs","search","creatable","displayOptionsMap","Map","forEach","hoverOptions","willCreateOption","concat","watch","val","nextTick","doFocus","debounceOnRemote","immediate","deep","handler","getRealOptions","console","error","document","addEventListener","keydownEvent","removeEventListener","mounted","checkVal","methods","arr","children","emitEvent","warn","multiLimitDisabled","max","visibleChange","monitorWidth","onOptionClick","e","index","removeTag","push","emitChange","hideMenu","reserveKeyword","context","stopPropagation","removeOption","tempValue","splice","clearSelect","getOptions","$el","className","valueLabelAble","destroyOptions","createOption","debounce","focus","blur","enter","inputValue","preventKeys","includes","code","preventDefault","initHoverindex","arrowDownOption","arrowUpOption","count","hoverEvent","v","getOverlayElm","r","$refs","popup","overlay","component","$nextTick","styles","select","width","elWidth","getBoundingClientRect","popupWidth","Math","min","ceil","timer","setTimeout","scrollHeight","clientHeight","clearTimeout","getEmpty","useLocale","empty","t","global","renderTNodeJSX","getLoadingText","loadingText","getPlaceholderText","getCloseIcon","closeIconClass","clearIcon","input","renderGroupOptions","groupList","group","divider","renderOptions","content","renderDataWithOptions","targetIndex","Object","i","parseInt","some","render","prefixIconSlot","emptySlot","loadingTextSlot","placeholderText","slots","bind","valueDisplay","params","onClose","minCollapsedNum","collapsedItems","collapsedSelectedItems","slice"],"mappings":"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"}