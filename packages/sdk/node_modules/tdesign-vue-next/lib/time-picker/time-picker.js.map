{"version":3,"file":"time-picker.js","sources":["../../src/time-picker/time-picker.tsx"],"sourcesContent":["import { defineComponent } from 'vue';\nimport dayjs from 'dayjs';\nimport isFunction from 'lodash/isFunction';\nimport customParseFormat from 'dayjs/plugin/customParseFormat';\n\nimport { TimeIcon } from 'tdesign-icons-vue-next';\nimport mixins from '../utils/mixins';\nimport getConfigReceiverMixins, { TimePickerConfig } from '../config-provider/config-receiver';\nimport { TimePickerPanelInstance, TimeInputEvent, InputTime, TimeInputType } from './interface';\nimport TPopup, { PopupVisibleChangeContext } from '../popup';\nimport { prefix } from '../config';\nimport CLASSNAMES from '../utils/classnames';\nimport PickerPanel from './panel';\nimport TInput from '../input';\nimport { emitEvent } from '../utils/event';\n\nimport InputItems from './input-items';\n\nimport props from './props';\n\nimport { EPickerCols, EMPTY_VALUE, COMPONENT_NAME, amFormat, pmFormat, AM } from './constant';\n\nconst name = `${prefix}-time-picker`;\n\ndayjs.extend(customParseFormat);\n\nexport default defineComponent({\n  ...mixins(getConfigReceiverMixins<TimePickerConfig>('timePicker')),\n  name: 'TTimePicker',\n\n  components: {\n    PickerPanel,\n    TimeIcon,\n    TPopup,\n    TInput,\n    InputItems,\n  },\n\n  props: { ...props },\n\n  emits: ['change', 'input', 'close', 'open', 'focus', 'blur'],\n\n  data() {\n    const { defaultValue, value } = this.$props;\n    // 初始化默认值\n    const time = value || defaultValue;\n    // 初始化数据\n    return {\n      els: [],\n      focus: false,\n      isShowPanel: false,\n      // 时间对象\n      time: time ? dayjs(time, this.format) : undefined,\n      // 初始值转input展示对象\n      inputTime: time ? this.setInputValue(dayjs(time, this.format)) : undefined,\n      needClear: false,\n    };\n  },\n\n  computed: {\n    // 传递给选择面板的时间值\n    panelValue(): Array<dayjs.Dayjs> {\n      const {\n        $data: { time },\n      } = this;\n      if (time) {\n        return [dayjs(time, this.format)];\n      }\n      if (this.steps.filter((step) => step !== 1).length < 1) {\n        return [dayjs()];\n      }\n      return [dayjs().hour(0).minute(0).second(0)];\n    },\n    textClassName(): string {\n      const isDefault = (this.inputTime as any).some(\n        (item: InputTime) => !!item.hour && !!item.minute && !!item.second,\n      );\n      return isDefault ? '' : `${name}__group-text`;\n    },\n  },\n\n  watch: {\n    // 监听选中时间变动\n    time: {\n      handler() {\n        this.output();\n      },\n    },\n    value: {\n      handler() {\n        this.time = this.value ? dayjs(this.value, this.format) : undefined;\n        this.inputTime = this.value ? this.setInputValue(dayjs(this.value, this.format)) : undefined;\n      },\n    },\n  },\n  methods: {\n    // 输入变化\n    inputChange(event: TimeInputEvent) {\n      const { type, value } = event;\n      const {\n        $data: {\n          // 鉴别是range还是单picker\n          time,\n        },\n      } = this;\n      let newTime = time;\n      if (value === EMPTY_VALUE) {\n        // 特殊标识，需要清空input\n        this.inputTime[type] = undefined;\n        // 需要重置该类型时间\n        newTime[type](0);\n        return;\n      }\n      if (!newTime) {\n        // 默认值不存在\n        newTime = dayjs();\n        newTime.hour(0);\n        newTime.minute(0);\n        newTime.second(0);\n      }\n      // 设置时间\n      newTime = newTime.set(type, value);\n      // 生成变动\n      this.time = dayjs(newTime);\n      // 转化展示数据\n      this.inputTime = this.setInputValue(this.time);\n      emitEvent(this, 'input', { input: value, value: this.time.format(this.format), e: event });\n      const panelRef = this.$refs.panel as TimePickerPanelInstance;\n      panelRef.panelColUpdate();\n    },\n    // @blur\n    onBlurDefault(e: Event, trigger: TimeInputType, index: number, input: number) {\n      emitEvent(this, 'blur', {\n        trigger,\n        input,\n        value: this.time.format(this.format),\n        e,\n      });\n    },\n    // @focus\n    onFocusDefault(e: Event, trigger: TimeInputType, index: number, input: number) {\n      emitEvent(this, 'focus', {\n        trigger,\n        input,\n        value: this.time.format(this.format),\n        e,\n      });\n    },\n    // 面板展示隐藏\n    panelVisibleChange(val: boolean, context?: PopupVisibleChangeContext) {\n      if (context) {\n        const isClickDoc = context.trigger === 'document';\n        this.isShowPanel = !isClickDoc;\n        emitEvent(this, isClickDoc ? 'close' : 'open');\n      } else {\n        this.isShowPanel = val;\n        emitEvent(this, val ? 'open' : 'close');\n      }\n    },\n    // 切换上下午\n    toggleInputMeridiem() {\n      const {\n        $data: { time },\n      } = this;\n      const current = time.format('A');\n      const currentHour = time.hour() + (current === AM ? 12 : -12);\n      // 时间变动\n      this.inputChange({\n        type: 'hour',\n        value: currentHour,\n      });\n    },\n    // 选中时间发生变动\n    pickTime(col: EPickerCols, change: string | number, index: number, value: Record<string, any>) {\n      const { time, format } = this;\n      let setTime = time;\n\n      if (EPickerCols.hour === col) {\n        setTime = value.set(\n          col,\n          value.hour() >= 12 && (amFormat.test(format) || pmFormat.test(format)) ? Number(change) + 12 : change,\n        );\n      } else if ([EPickerCols.minute, EPickerCols.second].includes(col)) {\n        setTime = value.set(col, change);\n      } else {\n        // 当前上下午\n        let currentHour = value.hour();\n        // 上下午\n        if (change === this.global.anteMeridiem && currentHour > 12) {\n          // 上午\n          currentHour -= 12;\n        } else if (change === this.global.postMeridiem && currentHour < 12) {\n          // 下午\n          currentHour += 12;\n        }\n        setTime = value.hour(currentHour);\n      }\n      this.time = setTime;\n\n      this.inputTime = this.setInputValue(setTime);\n      const formatValue = dayjs(setTime).format(this.format);\n      emitEvent(this, 'change', formatValue);\n    },\n    // 确定按钮\n    makeSure() {\n      this.panelVisibleChange(false);\n      this.output();\n    },\n    // 此刻按钮\n    nowAction() {\n      const currentTime = dayjs();\n      // 如果此刻在不可选的时间上, 直接return\n      if (\n        isFunction(this.disableTime) &&\n        this.disableTime(currentTime.get('hour'), currentTime.get('minute'), currentTime.get('second'))\n      ) {\n        return;\n      }\n      this.time = currentTime;\n      this.inputTime = this.setInputValue(this.time);\n      emitEvent(this, 'change', currentTime.format(this.format));\n    },\n    // format输出结果\n    output() {\n      if (this.needClear) {\n        this.inputTime = this.setInputValue(undefined);\n        this.needClear = false;\n      } else {\n        this.time = this.time ?? dayjs();\n        this.inputTime = this.setInputValue(this.time);\n      }\n    },\n    // 设置输入框展示\n    setInputValue(val: dayjs.Dayjs | undefined): InputTime | undefined {\n      const ans: InputTime = {\n        hour: undefined,\n        minute: undefined,\n        second: undefined,\n        meridiem: AM,\n      };\n      if (!val) return ans;\n      return this.dayjs2InputTime(val);\n    },\n    // dayjs对象转换输入展示数据\n    dayjs2InputTime(val: dayjs.Dayjs): InputTime {\n      const {\n        $props: { format },\n      } = this;\n      if (!val) {\n        return {\n          hour: undefined,\n          minute: undefined,\n          second: undefined,\n          meridiem: AM,\n        };\n      }\n\n      let hour: number | string = val.hour();\n      let minute: number | string = val.minute();\n      let second: number | string = val.second();\n      // 判断12小时制上下午显示问题\n      if (/[h]{1}/.test(format)) {\n        hour %= 12;\n      }\n      // 判定是否补齐小于10\n      if (/[h|H]{2}/.test(format)) {\n        hour = hour < 10 ? `0${hour}` : hour;\n      }\n      if (/[m|M]{2}/.test(format)) {\n        minute = minute < 10 ? `0${minute}` : minute;\n      }\n      if (/[s|S]{2}/.test(format)) {\n        second = second < 10 ? `0${second}` : second;\n      }\n\n      return {\n        hour,\n        minute,\n        second,\n        meridiem: val.format('a'),\n      };\n    },\n    // 清除选中\n    clear(context: { e: MouseEvent }) {\n      const { e } = context;\n      this.time = undefined;\n      this.needClear = true;\n      this.inputTime = this.setInputValue(undefined);\n      emitEvent(this, 'change', undefined);\n      e.stopPropagation();\n    },\n    renderInput() {\n      const classes = [\n        `${name}__group`,\n        {\n          [`${prefix}-is-focused`]: this.isShowPanel,\n        },\n      ];\n\n      const slots = {\n        'suffix-icon': () => <time-icon />,\n      };\n      return (\n        <div class={classes} onClick={() => (this.isShowPanel = true)}>\n          <t-input\n            disabled={this.disabled}\n            size={this.size}\n            onClear={this.clear}\n            clearable={this.clearable}\n            readonly\n            placeholder=\" \"\n            value={this.time ? ' ' : undefined}\n            class={this.isShowPanel ? `${prefix}-is-focused` : ''}\n            v-slots={slots}\n          ></t-input>\n          <input-items\n            size={this.size}\n            dayjs={this.inputTime}\n            disabled={this.disabled}\n            format={this.format}\n            steps={this.steps}\n            allowInput={this.allowInput}\n            placeholder={this.placeholder || this.global.placeholder}\n            onToggleMeridiem={() => this.toggleInputMeridiem()}\n            onBlurDefault={this.onBlurDefault}\n            onFocusDefault={this.onFocusDefault}\n            onChange={(e: TimeInputEvent) => this.inputChange(e)}\n          />\n        </div>\n      );\n    },\n  },\n\n  render() {\n    // 初始化数据\n    const { size, disabled } = this;\n    // 样式类名\n    const classes = [name, CLASSNAMES.SIZE[size] || ''];\n    // TODO: 需要透传外部传入的class\n\n    const slots = {\n      content: () => (\n        <picker-panel\n          ref=\"panel\"\n          format={this.format}\n          value={this.panelValue}\n          disabled={this.disabled}\n          isShowPanel={this.isShowPanel}\n          onTimePick={this.pickTime}\n          onSure={this.makeSure}\n          onNowAction={this.nowAction}\n          steps={this.steps}\n          hideDisabledTime={this.hideDisabledTime}\n          disableTime={this.disableTime}\n          isFocus={this.focus}\n        />\n      ),\n    };\n\n    return (\n      <t-popup\n        ref=\"popup\"\n        placement=\"bottom-left\"\n        class={classes}\n        trigger=\"click\"\n        disabled={disabled}\n        visible={this.isShowPanel}\n        overlayClassName={`${COMPONENT_NAME}__panel-container`}\n        onVisibleChange={this.panelVisibleChange}\n        expandAnimation={true}\n        v-slots={slots}\n      >\n        {this.renderInput()}\n      </t-popup>\n    );\n  },\n});\n"],"names":["name","prefix","dayjs","extend","customParseFormat","defineComponent","mixins","getConfigReceiverMixins","components","PickerPanel","TimeIcon","TPopup","TInput","InputItems","props","emits","data","$props","defaultValue","value","time","els","focus","isShowPanel","format","inputTime","setInputValue","needClear","computed","panelValue","$data","steps","filter","step","length","hour","minute","second","textClassName","isDefault","some","item","watch","handler","output","methods","inputChange","event","type","newTime","EMPTY_VALUE","set","emitEvent","input","e","panelRef","$refs","panel","panelColUpdate","onBlurDefault","trigger","index","onFocusDefault","panelVisibleChange","val","context","isClickDoc","toggleInputMeridiem","current","currentHour","AM","pickTime","col","change","setTime","EPickerCols","amFormat","test","pmFormat","Number","includes","global","anteMeridiem","postMeridiem","formatValue","makeSure","nowAction","currentTime","isFunction","disableTime","get","ans","meridiem","dayjs2InputTime","clear","stopPropagation","renderInput","classes","slots","disabled","size","clearable","allowInput","placeholder","render","CLASSNAMES","SIZE","content","hideDisabledTime","COMPONENT_NAME"],"mappings":"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"}