{"version":3,"file":"time-range-picker.js","sources":["../../src/time-picker/time-range-picker.tsx"],"sourcesContent":["import { defineComponent } from 'vue';\nimport dayjs from 'dayjs';\nimport customParseFormat from 'dayjs/plugin/customParseFormat';\nimport isFunction from 'lodash/isFunction';\nimport isEqual from 'lodash/isEqual';\nimport { TimeIcon } from 'tdesign-icons-vue-next';\n\nimport mixins from '../utils/mixins';\nimport getConfigReceiverMixins, { TimePickerConfig } from '../config-provider/config-receiver';\nimport { TimeInputEvent, InputTime, TimePickerPanelInstance } from './interface';\nimport TPopup, { PopupVisibleChangeContext } from '../popup';\nimport { prefix } from '../config';\nimport CLASSNAMES from '../utils/classnames';\nimport PickerPanel from './panel';\nimport TInput from '../input';\nimport InputItems from './input-items';\nimport props from './time-range-picker-props';\nimport { emitEvent } from '../utils/event';\n\nimport { EPickerCols, TIME_PICKER_EMPTY, EMPTY_VALUE, COMPONENT_NAME, amFormat, pmFormat, AM } from './constant';\n\nconst name = `${prefix}-time-picker`;\n\ndayjs.extend(customParseFormat);\n\nexport default defineComponent({\n  ...mixins(getConfigReceiverMixins<TimePickerConfig>('timePicker')),\n  name: `${prefix}-time-range-picker`,\n\n  components: {\n    PickerPanel,\n    TimeIcon,\n    InputItems,\n    TPopup,\n    TInput,\n  },\n\n  props: { ...props },\n\n  emits: ['input', 'click', 'blur', 'focus', 'change', 'close', 'open'],\n  data() {\n    // 初始化数据\n    return {\n      els: [],\n      focus: false,\n      isShowPanel: false,\n      // 时间对象\n      time: TIME_PICKER_EMPTY as Array<dayjs.Dayjs>,\n      // 初始值转input展示对象\n      inputTime: TIME_PICKER_EMPTY as Array<InputTime>,\n    };\n  },\n\n  computed: {\n    // 传递给选择面板的时间值\n    panelValue(): Array<dayjs.Dayjs> {\n      const time = this.time || TIME_PICKER_EMPTY;\n      return time.map((val: dayjs.Dayjs) => (val ? dayjs(val) : dayjs()));\n    },\n    textClassName(): string {\n      const isDefault = (this.inputTime as any).some(\n        (item: InputTime) => !!item.hour && !!item.minute && !!item.second,\n      );\n      return isDefault ? '' : `${name}__group-text`;\n    },\n  },\n\n  watch: {\n    value: {\n      handler(val, oldVal) {\n        if (JSON.stringify(val) === JSON.stringify(oldVal)) return;\n        const values = Array.isArray(this.value) ? this.value : [];\n        const { format } = this;\n        function getVal(value: string | undefined) {\n          return value ? dayjs(value, format) : undefined;\n        }\n        const dayjsList = [getVal(values[0]), getVal(values[1])];\n        this.time = dayjsList;\n        this.updateInputTime();\n      },\n      immediate: true,\n    },\n  },\n  methods: {\n    // 输入变化\n    inputChange(event: TimeInputEvent) {\n      const { type, value, index } = event;\n      let newTime = this.time[index];\n      if (value === EMPTY_VALUE) {\n        // 特殊标识，需要清空input\n        this.inputTime[index][type] = undefined;\n        // 需要重置该类型时间\n        newTime[type](0);\n        return;\n      }\n      if (!newTime) {\n        // 默认值不存在\n        newTime = dayjs();\n        newTime.hour(0);\n        newTime.minute(0);\n        newTime.second(0);\n      }\n      newTime = newTime.set(type, value);\n      // 生成变动\n      this.time[index] = dayjs(newTime);\n      // 转化展示数据\n      this.updateInputTime();\n\n      emitEvent(this, 'input', { input: value, value: this.time[index].format(this.format), e: event });\n      const panelRef = this.$refs.panel as TimePickerPanelInstance;\n      panelRef.panelColUpdate();\n    },\n    getFormatValues() {\n      const values: Array<string> = [];\n      this.time.forEach((time) => {\n        if (time) {\n          values.push(time.format(this.format));\n        }\n      });\n      return values;\n    },\n    // @blur\n    onBlurDefault(e: Event) {\n      const value = this.getFormatValues();\n      emitEvent(this, 'blur', { value, e });\n    },\n    // @focus\n    onFocusDefault(e: Event) {\n      const value = this.getFormatValues();\n      emitEvent(this, 'focus', { value, e });\n    },\n    // 面板展示隐藏\n    panelVisibleChange(val: boolean, context?: PopupVisibleChangeContext) {\n      if (context) {\n        const isClickDoc = context.trigger === 'document';\n        this.isShowPanel = !isClickDoc;\n        emitEvent(this, isClickDoc ? 'close' : 'open');\n      } else {\n        this.isShowPanel = val;\n        emitEvent(this, val ? 'open' : 'close');\n      }\n    },\n    // 切换上下午\n    toggleInputMeridiem(index: number) {\n      const curTime = this.time[index];\n      const current = curTime.format('a');\n      const currentHour = curTime.hour() + (current === AM ? 12 : -12);\n      // 时间变动\n      this.inputChange({ type: 'hour', value: currentHour, index });\n    },\n    // 选中时间发生变动\n    pickTime(col: EPickerCols, change: string | number, index: number, value: Record<string, any>) {\n      const { time, format } = this;\n      const panelRef = this.$refs.panel as TimePickerPanelInstance;\n      let shouldUpdatePanel = false;\n      let setTime = time[index];\n      if (EPickerCols.hour === col) {\n        setTime = value.set(\n          col,\n          value.hour() >= 12 && (amFormat.test(format) || pmFormat.test(format)) ? Number(change) + 12 : change,\n        );\n      } else if ([EPickerCols.minute, EPickerCols.second].includes(col)) {\n        setTime = value.set(col, change);\n      } else {\n        // 当前上下午\n        let currentHour = value.hour();\n        // 上下午\n        if (change === this.global.anteMeridiem) {\n          // 上午\n          currentHour -= 12;\n        } else if (change === this.global.postMeridiem) {\n          // 下午\n          currentHour += 12;\n        }\n        setTime = value.hour(currentHour);\n      }\n      this.time[index] = setTime;\n      // 处理初始化为空的逻辑\n      if (index === 0 && !this.time[1]) {\n        this.time[1] = setTime;\n        shouldUpdatePanel = true;\n      } else if (index === 1 && !this.time[0]) {\n        this.time[0] = dayjs().hour(0).minute(0).second(0);\n        shouldUpdatePanel = true;\n      }\n      this.updateInputTime();\n      shouldUpdatePanel && panelRef.panelColUpdate();\n    },\n    // 确定按钮\n    makeSure() {\n      this.panelVisibleChange(false);\n    },\n    // 设置输入框展示\n    updateInputTime() {\n      const {\n        $props: { format },\n      } = this;\n      const disPlayValues: Array<InputTime> = [];\n      (this.time || []).forEach((time: dayjs.Dayjs | undefined) => {\n        if (!time) {\n          disPlayValues.push({\n            hour: undefined,\n            minute: undefined,\n            second: undefined,\n            meridiem: AM,\n          });\n        } else {\n          let hour: number | string = time.hour();\n          let minute: number | string = time.minute();\n          let second: number | string = time.second();\n          // 判断12小时制上下午显示问题\n          if (/[h]{1}/.test(format)) {\n            hour %= 12;\n          }\n          // 判定是否补齐小于10\n          if (/[h|H]{2}/.test(format)) {\n            hour = hour < 10 ? `0${hour}` : hour;\n          }\n          if (/[m|M]{2}/.test(format)) {\n            minute = minute < 10 ? `0${minute}` : minute;\n          }\n          if (/[s|S]{2}/.test(format)) {\n            second = second < 10 ? `0${second}` : second;\n          }\n          disPlayValues.push({\n            hour,\n            minute,\n            second,\n            meridiem: time.format('a'),\n          });\n        }\n      });\n      this.inputTime = disPlayValues;\n      this.triggerUpdateValue();\n    },\n    // 清除选中\n    clear(context: { e: MouseEvent }) {\n      const { e } = context;\n      this.time = TIME_PICKER_EMPTY;\n      this.updateInputTime();\n      e.stopPropagation();\n    },\n    triggerUpdateValue() {\n      const values: Array<string> = [];\n      this.time.forEach((time) => {\n        if (time) {\n          values.push(time.format(this.format));\n        }\n      });\n      emitEvent(this, 'change', values);\n      isFunction(this.onChange) && this.onChange(values);\n    },\n    renderInput() {\n      const classes = [\n        `${name}__group`,\n        {\n          [`${prefix}-is-focused`]: this.isShowPanel,\n        },\n      ];\n      return (\n        <div class={classes} onClick={() => (this.isShowPanel = true)}>\n          <t-input\n            disabled={this.disabled}\n            size={this.size}\n            onClear={this.clear}\n            clearable={this.clearable}\n            placeholder=\" \"\n            readonly\n            value={!isEqual(this.time, TIME_PICKER_EMPTY) ? ' ' : undefined}\n          >\n            <time-icon slot=\"suffix-icon\"></time-icon>\n          </t-input>\n          <input-items\n            size={this.size}\n            dayjs={this.inputTime}\n            disabled={this.disabled}\n            format={this.format}\n            allowInput={this.allowInput}\n            placeholder={this.placeholder || this.global.placeholder}\n            isRangePicker\n            onToggleMeridiem={(index: number) => this.toggleInputMeridiem(index)}\n            onBlurDefault={this.onBlurDefault}\n            onFocusDefault={this.onFocusDefault}\n            onChange={(e: TimeInputEvent) => this.inputChange(e)}\n            steps={this.steps}\n          />\n        </div>\n      );\n    },\n  },\n  render() {\n    // 初始化数据\n    const {\n      $props: { size, disabled },\n    } = this;\n    // 样式类名\n    const classes = [name, CLASSNAMES.SIZE[size]];\n\n    const slots = {\n      content: () => (\n        <picker-panel\n          ref=\"panel\"\n          format={this.format}\n          value={this.panelValue}\n          disabled={this.disabled}\n          isShowPanel={this.isShowPanel}\n          onTimePick={this.pickTime}\n          onSure={this.makeSure}\n          steps={this.steps}\n          hideDisabledTime={this.hideDisabledTime}\n          disableTime={this.disableTime}\n          isFocus={this.focus}\n        />\n      ),\n    };\n\n    return (\n      <t-popup\n        ref=\"popup\"\n        class={classes}\n        placement=\"bottom-left\"\n        trigger=\"click\"\n        disabled={disabled}\n        visible={this.isShowPanel}\n        overlayClassName={`${COMPONENT_NAME}__panel-container`}\n        onVisibleChange={this.panelVisibleChange}\n        expandAnimation={true}\n        v-slots={slots}\n      >\n        {this.renderInput()}\n      </t-popup>\n    );\n  },\n});\n"],"names":["name","prefix","dayjs","extend","customParseFormat","defineComponent","mixins","getConfigReceiverMixins","components","PickerPanel","TimeIcon","InputItems","TPopup","TInput","props","emits","data","els","focus","isShowPanel","time","TIME_PICKER_EMPTY","inputTime","computed","panelValue","map","val","textClassName","isDefault","some","item","hour","minute","second","watch","value","handler","oldVal","JSON","stringify","values","Array","isArray","format","getVal","dayjsList","updateInputTime","immediate","methods","inputChange","event","type","index","newTime","EMPTY_VALUE","set","emitEvent","input","e","panelRef","$refs","panel","panelColUpdate","getFormatValues","forEach","push","onBlurDefault","onFocusDefault","panelVisibleChange","context","isClickDoc","trigger","toggleInputMeridiem","curTime","current","currentHour","AM","pickTime","col","change","shouldUpdatePanel","setTime","EPickerCols","amFormat","test","pmFormat","Number","includes","global","anteMeridiem","postMeridiem","makeSure","$props","disPlayValues","meridiem","triggerUpdateValue","clear","stopPropagation","isFunction","onChange","renderInput","classes","disabled","size","clearable","isEqual","allowInput","placeholder","steps","render","CLASSNAMES","SIZE","slots","content","hideDisabledTime","disableTime","COMPONENT_NAME"],"mappings":"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"}