{"version":3,"file":"list.js","sources":["../../src/list/list.tsx"],"sourcesContent":["import { defineComponent, VNodeChild } from 'vue';\nimport TLoading from '../loading';\nimport { prefix } from '../config';\nimport props from './props';\nimport { renderTNodeJSX } from '../utils/render-tnode';\nimport CLASSNAMES from '../utils/classnames';\nimport { LOAD_MORE, LOADING } from './const';\nimport { ClassName } from '../common';\nimport { emitEvent } from '../utils/event';\n\nconst name = `${prefix}-list`;\n\nexport default defineComponent({\n  name: 'TList',\n  props: {\n    ...props,\n  },\n  emits: ['scroll', 'load-more'],\n  computed: {\n    listClass(): ClassName {\n      return [\n        `${name}`,\n        CLASSNAMES.SIZE[this.size],\n        {\n          [`${name}--split`]: this.split,\n          [`${name}--stripe`]: this.stripe,\n          [`${name}--vertical-action`]: this.layout === 'vertical',\n        },\n      ];\n    },\n    loadingClass(): ClassName {\n      return typeof this.asyncLoading === 'string' && ['loading', 'load-more'].includes(this.asyncLoading)\n        ? `${name}__load ${name}__load--${this.asyncLoading}`\n        : `${name}__load`;\n    },\n  },\n  methods: {\n    renderLoading() {\n      if (this.asyncLoading && typeof this.asyncLoading === 'string') {\n        if (this.asyncLoading === LOADING) {\n          return (\n            <div>\n              <TLoading />\n              <span>正在加载中，请稍等</span>\n            </div>\n          );\n        }\n        if (this.asyncLoading === LOAD_MORE) {\n          return <span>点击加载更多</span>;\n        }\n      }\n      return renderTNodeJSX(this, 'asyncLoading');\n    },\n    handleScroll(e: WheelEvent | Event) {\n      const listElement = this.$el as HTMLElement;\n      const { scrollTop, scrollHeight, clientHeight } = listElement;\n      emitEvent(this, 'scroll', {\n        $event: e,\n        scrollTop,\n        scrollBottom: scrollHeight - clientHeight - scrollTop,\n      });\n    },\n    handleLoadMore(e: MouseEvent) {\n      if (typeof this.asyncLoading === 'string' && this.asyncLoading !== LOAD_MORE) return;\n      emitEvent(this, 'load-more', { e });\n    },\n    renderContent(): VNodeChild {\n      const propsHeaderContent = renderTNodeJSX(this, 'header');\n      const propsFooterContent = renderTNodeJSX(this, 'footer');\n\n      return [\n        propsHeaderContent && <div class={`${name}__header`}>{propsHeaderContent}</div>,\n        <ul class={`${name}__inner`}>{renderTNodeJSX(this, 'default')}</ul>,\n        propsFooterContent && <div class={`${name}__footer`}>{propsFooterContent}</div>,\n      ];\n    },\n  },\n  render() {\n    let listContent = this.renderContent();\n\n    listContent = [\n      listContent,\n      <div class={this.loadingClass} onClick={this.handleLoadMore}>\n        {this.renderLoading()}\n      </div>,\n    ];\n\n    return (\n      <div class={this.listClass} onScroll={this.handleScroll}>\n        {listContent}\n      </div>\n    );\n  },\n});\n"],"names":["name","prefix","defineComponent","props","emits","computed","listClass","CLASSNAMES","SIZE","size","split","stripe","layout","loadingClass","asyncLoading","includes","methods","renderLoading","LOADING","LOAD_MORE","renderTNodeJSX","handleScroll","e","listElement","$el","scrollTop","scrollHeight","clientHeight","emitEvent","$event","scrollBottom","handleLoadMore","renderContent","propsHeaderContent","propsFooterContent","render","listContent"],"mappings":"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"}