{"version":3,"file":"menu-item.js","sources":["../../src/menu/menu-item.tsx"],"sourcesContent":["import { defineComponent, computed, inject, onMounted, getCurrentInstance } from 'vue';\nimport { prefix } from '../config';\nimport props from './menu-item-props';\nimport { TdMenuInterface, TdSubMenuInterface } from './const';\nimport ripple from '../utils/ripple';\nimport { renderContent, renderTNodeJSX } from '../utils/render-tnode';\nimport { emitEvent } from '../utils/event';\n\nexport default defineComponent({\n  name: 'TMenuItem',\n  directives: { ripple },\n  props: { ...props },\n  emits: ['click'],\n  setup(props, ctx) {\n    const menu = inject<TdMenuInterface>('TdMenu');\n    const submenu = inject<TdSubMenuInterface>('TdSubmenu', null);\n    const active = computed(() => menu.activeValue.value === props.value);\n    const classes = computed(() => [\n      `${prefix}-menu__item`,\n      {\n        [`${prefix}-is-active`]: active.value,\n        [`${prefix}-is-disabled`]: props.disabled,\n        [`${prefix}-menu__item--plain`]: !ctx.slots.icon && !props.icon,\n        [`${prefix}-submenu__item`]: !!submenu && !menu.isHead,\n      },\n    ]);\n\n    // lifetimes\n    onMounted(() => {\n      menu?.vMenu?.add({ value: props.value, parent: submenu?.value, vnode: ctx.slots.default });\n    });\n\n    return {\n      menu,\n      active,\n      classes,\n    };\n  },\n  methods: {\n    handleClick() {\n      if (this.disabled) return;\n      this.menu.select(this.value);\n      emitEvent(this, 'click');\n      if (this.href) {\n        window.open(this.href, this.target);\n      } else if (this.to) {\n        const router = this.router || this.$router;\n        const methods: string = props.replace ? 'replace' : 'push';\n        router[methods](this.to).catch((err: Error) => {\n          // vue-router 3.1.0+ push/replace cause NavigationDuplicated error\n          // https://github.com/vuejs/vue-router/issues/2872\n          // 当前path和目标path相同时，会抛出NavigationDuplicated的错误\n          if (\n            err.name !== 'NavigationDuplicated' &&\n            !err.message.includes('Avoided redundant navigation to current location')\n          ) {\n            throw err;\n          }\n        });\n      }\n    },\n  },\n  render() {\n    return (\n      <li v-ripple class={this.classes} onClick={this.handleClick}>\n        {renderTNodeJSX(this, 'icon')}\n        <span class={[`${prefix}-menu__content`]}>{renderContent(this, 'default', 'content')}</span>\n      </li>\n    );\n  },\n});\n"],"names":["defineComponent","name","directives","ripple","props","emits","setup","props2","ctx","menu","inject","submenu","active","computed","activeValue","value","classes","prefix","disabled","slots","icon","isHead","onMounted","vMenu","add","parent","vnode","methods","handleClick","select","emitEvent","href","window","open","target","to","router","$router","replace","err","message","includes","render","renderTNodeJSX","renderContent"],"mappings":"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"}