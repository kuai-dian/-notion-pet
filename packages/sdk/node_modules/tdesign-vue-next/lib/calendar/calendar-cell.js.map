{"version":3,"file":"calendar-cell.js","sources":["../../src/calendar/calendar-cell.tsx"],"sourcesContent":["import { defineComponent } from 'vue';\nimport dayjs from 'dayjs';\nimport { prefix } from '../config';\nimport { emitEvent } from '../utils/event';\n\n// 通用库\n\n// 组件的一些常量\nimport { COMPONENT_NAME } from './const';\n\n// 组件相关的自定义类型\nimport { CalendarCell } from './type';\nimport { renderTNodeJSXDefault, renderTNodeJSX } from '../utils/render-tnode';\n\nconst clickTypeEmitEventMap = {\n  click: 'click',\n  dblclick: 'dblclick',\n  contextmenu: 'rightclick',\n};\n\nexport default defineComponent({\n  name: `${COMPONENT_NAME}-cell`,\n  inheritAttrs: false,\n  props: {\n    item: {\n      type: Object,\n      default: (): CalendarCell => null,\n    },\n    fillWithZero: {\n      type: Boolean,\n      default: undefined,\n    },\n    theme: {\n      type: String,\n      default: (): string => null,\n    },\n    t: Function,\n    global: Object,\n    cell: Function,\n  },\n  emits: ['click', 'dblclick', 'rightclick'],\n  computed: {\n    allowSlot(): boolean {\n      return this.theme === 'full';\n    },\n    disabled(): boolean {\n      return this.item.mode === 'month' && this.item.belongTo !== 0;\n    },\n    valueDisplay(): string {\n      if (this.item.mode === 'month') {\n        const dateNum = this.item.date.getDate();\n        const fillZero = dateNum < 10 && (this.fillWithZero ?? this.global.fillWithZero ?? true);\n        return fillZero ? `0${dateNum}` : dateNum;\n      }\n      const map = this.t(this.global.cellMonth).split(',');\n      return map[this.item.date.getMonth().toString()];\n    },\n    cellCls(): Record<string, any> {\n      const { mode, date, formattedDate, isCurrent } = this.item;\n      const isNow =\n        mode === 'year' ? new Date().getMonth() === date.getMonth() : formattedDate === dayjs().format('YYYY-MM-DD');\n      return [\n        `${prefix}-calendar__table-body-cell`,\n        {\n          [`${prefix}-is-disabled`]: this.disabled,\n          [`${prefix}-is-checked`]: isCurrent,\n          [`${COMPONENT_NAME}__table-body-cell--now`]: isNow,\n        },\n      ];\n    },\n  },\n  methods: {\n    clickCell(e: MouseEvent) {\n      if (this.disabled) return;\n      emitEvent(this, clickTypeEmitEventMap[e.type], e);\n    },\n  },\n  render() {\n    // const { item, cellCls, clickCell, dblclick, contextmenuClick, valueDisplay, allowSlot } = this;\n    const { item, cellCls, clickCell, valueDisplay, allowSlot } = this;\n\n    const defaultNode = () => (\n      <span>\n        <div class={`${prefix}-calendar__table-body-cell-display`}>{valueDisplay}</div>\n        <div class={`${prefix}-calendar__table-body-cell-content`}>\n          {allowSlot &&\n            renderTNodeJSX(this, 'cellAppend', {\n              params: item,\n            })}\n        </div>\n      </span>\n    );\n\n    return (\n      item && (\n        <div class={cellCls} onClick={clickCell} ondblclick={clickCell} oncontextmenu={clickCell}>\n          {typeof this.cell === 'function'\n            ? this.cell(item)\n            : renderTNodeJSXDefault(this, 'cell', {\n                defaultNode: defaultNode(),\n                params: item,\n              })}\n        </div>\n      )\n    );\n  },\n});\n"],"names":["clickTypeEmitEventMap","click","dblclick","contextmenu","defineComponent","name","COMPONENT_NAME","inheritAttrs","props","item","type","Object","fillWithZero","Boolean","theme","String","t","Function","global","cell","emits","computed","allowSlot","disabled","mode","belongTo","valueDisplay","dateNum","date","getDate","fillZero","map","cellMonth","split","getMonth","toString","cellCls","formattedDate","isCurrent","isNow","Date","dayjs","format","prefix","methods","clickCell","e","emitEvent","render","defaultNode","renderTNodeJSX","params","renderTNodeJSXDefault"],"mappings":"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"}