{"version":3,"file":"group.js","sources":["../../src/radio/group.tsx"],"sourcesContent":["import { VNode, defineComponent, h } from 'vue';\nimport isString from 'lodash/isString';\nimport isNumber from 'lodash/isNumber';\nimport props from './radio-group-props';\nimport { RadioOptionObj, RadioOption, RadioValue } from './type';\nimport { prefix } from '../config';\nimport Radio, { radioBtnName } from './radio';\nimport { TNodeReturnValue } from '../common';\nimport CLASSNAMES, { SIZE_CLASSNAMES } from '../utils/classnames';\nimport { emitEvent } from '../utils/event';\n\nconst name = `${prefix}-radio-group`;\n\nexport default defineComponent({\n  name: 'TRadioGroup',\n\n  components: {\n    Radio,\n  },\n\n  provide() {\n    return {\n      radioGroup: this,\n    };\n  },\n  props: { ...props },\n\n  emits: ['change'],\n\n  data() {\n    return {\n      barStyle: { width: '0px', left: '0px' },\n      observer: null,\n    };\n  },\n  computed: {\n    checkedClassName() {\n      return `.${radioBtnName}.${CLASSNAMES.STATUS.checked}`;\n    },\n  },\n  watch: {\n    value() {\n      this.$nextTick(() => {\n        this.calcBarStyle();\n      });\n    },\n  },\n\n  mounted() {\n    this.calcBarStyle();\n  },\n\n  methods: {\n    handleRadioChange(value: RadioValue, context: { e: Event }) {\n      emitEvent(this, 'change', value, context);\n    },\n    calcDefaultBarStyle() {\n      const defaultNode = this.$el.cloneNode(true);\n      const div = document.createElement('div');\n      div.setAttribute('style', 'position: absolute; visibility: hidden;');\n      div.appendChild(defaultNode);\n      document.body.appendChild(div);\n\n      const defaultCheckedRadio: HTMLElement = div.querySelector(this.checkedClassName);\n      const { offsetWidth, offsetLeft } = defaultCheckedRadio;\n      this.barStyle = { width: `${offsetWidth}px`, left: `${offsetLeft}px` };\n      document.body.removeChild(div);\n    },\n    calcBarStyle() {\n      if (this.variant === 'outline') return;\n\n      const checkedRadio: HTMLElement = this.$el.querySelector(this.checkedClassName);\n      if (!checkedRadio) return;\n\n      const { offsetWidth, offsetLeft } = checkedRadio;\n      // current node is not renderedï¼Œfallback to default render\n      if (!offsetWidth) {\n        this.calcDefaultBarStyle();\n      } else {\n        this.barStyle = { width: `${offsetWidth}px`, left: `${offsetLeft}px` };\n      }\n    },\n  },\n\n  render(): VNode {\n    const { $slots } = this;\n    let children: TNodeReturnValue = $slots.default && $slots.default(null);\n\n    if (this.options && this.options.length) {\n      children = this.options.map((option: RadioOption) => {\n        let opt = option as RadioOptionObj;\n        if (isNumber(option) || isString(option)) {\n          opt = { value: option, label: option.toString() };\n        }\n        return (\n          <Radio\n            key={`radio-group-options-${opt.value}-${Math.random()}`}\n            name={this.name}\n            checked={this.value === opt.value}\n            disabled={'disabled' in opt ? opt.disabled : this.disabled}\n            value={opt.value}\n          >\n            {typeof opt.label === 'function' ? opt.label(h) : opt.label}\n          </Radio>\n        );\n      });\n    }\n\n    const groupClass = [\n      `${name}`,\n      SIZE_CLASSNAMES[this.size],\n      {\n        [`${name}__outline`]: this.variant === 'outline',\n        [`${name}--filled`]: this.variant.includes('filled'),\n        [`${name}--primary-filled`]: this.variant === 'primary-filled',\n      },\n    ];\n    if (this.variant.includes('filled')) {\n      children && children.push(<div style={this.barStyle} class={`${name}__bg-block`}></div>);\n    }\n    return <div class={groupClass}>{children}</div>;\n  },\n});\n"],"names":["name","prefix","defineComponent","components","Radio","provide","radioGroup","props","emits","data","barStyle","width","left","observer","computed","checkedClassName","radioBtnName","CLASSNAMES","STATUS","checked","watch","value","$nextTick","calcBarStyle","mounted","methods","handleRadioChange","context","emitEvent","calcDefaultBarStyle","defaultNode","$el","cloneNode","div","document","createElement","setAttribute","appendChild","body","defaultCheckedRadio","querySelector","offsetWidth","offsetLeft","removeChild","variant","checkedRadio","render","$slots","children","options","length","map","option","opt","isNumber","isString","label","toString","Math","random","disabled","h","groupClass","SIZE_CLASSNAMES","size","includes","push"],"mappings":"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"}