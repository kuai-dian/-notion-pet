{"version":3,"file":"inputContent.js","sources":["../../../src/cascader/utils/inputContent.ts"],"sourcesContent":["import isFunction from 'lodash/isFunction';\nimport isEmpty from 'lodash/isEmpty';\nimport { TreeNode, CascaderContextType, TreeNodeValue, CascaderProps } from '../interface';\n\n/**\n * icon Class\n * @param prefix\n * @param CLASSNAMES\n * @param cascaderContext\n * @returns\n */\nexport function getCloseIconClass(prefix: string, CLASSNAMES: any, cascaderContext: CascaderContextType) {\n  const { visible, disabled } = cascaderContext;\n  return [\n    `${prefix}-cascader__icon`,\n    {\n      [CLASSNAMES.STATUS.visible]: visible,\n      [CLASSNAMES.STATUS.disabled]: disabled,\n    },\n  ];\n}\n\n/**\n * icon Class\n * @param prefix\n * @param CLASSNAMES\n * @param cascaderContext\n * @returns\n */\nexport function getFakeArrowIconClass(prefix: string, CLASSNAMES: any, cascaderContext: CascaderContextType) {\n  const { disabled } = cascaderContext;\n  return [\n    `${prefix}-cascader__icon`,\n    {\n      [CLASSNAMES.STATUS.disabled]: disabled,\n    },\n  ];\n}\n\n/**\n * Cascader外显div class\n * @param prefix\n * @param CLASSNAMES\n * @param cascaderContext\n * @returns\n */\nexport function getCascaderInnerClasses(prefix: string, CLASSNAMES: any, cascaderContext: CascaderContextType) {\n  const { disabled, visible, size, multiple } = cascaderContext;\n  return [\n    `${prefix}-cascader`,\n    {\n      [CLASSNAMES.STATUS.disabled]: disabled,\n      [CLASSNAMES.STATUS.active]: visible,\n      [CLASSNAMES.SIZE[size]]: size,\n      [`${prefix}-cascader--multiple`]: multiple,\n    },\n  ];\n}\n\n/**\n * closeIcon 是否显示\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getCloseShow(isHover: boolean, cascaderContext: CascaderContextType) {\n  const { value, disabled, clearable, visible } = cascaderContext;\n  return !!(!visible && clearable && isHover && !disabled && !isEmpty(value));\n}\n\n/**\n * Placeholder 是否显示\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getPlaceholderShow(\n  cascaderContext: CascaderContextType,\n  singleContent: string,\n  multipleContent: TreeNode[],\n) {\n  const { filterable, visible, multiple } = cascaderContext;\n  const valEmpty = !(multiple ? multipleContent.length : singleContent);\n  if (filterable) {\n    return valEmpty && !visible;\n  }\n  return valEmpty;\n}\n\n/**\n * 单选状态下内容\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getSingleContent(cascaderContext: CascaderContextType) {\n  const { value, multiple, treeStore, showAllLevels, setValue } = cascaderContext;\n  if (multiple || !value) return '';\n\n  if (Array.isArray(value)) return '';\n  const node = treeStore && treeStore.getNodes(value as TreeNodeValue | TreeNode);\n  if (!(node && node.length)) {\n    if (value) {\n      setValue(multiple ? [] : '', 'invalid-value');\n    }\n    return '';\n  }\n  const path = node && node[0].getPath();\n  if (path && path.length) {\n    return showAllLevels ? path.map((node: TreeNode) => node.label).join(' / ') : path[path.length - 1].label;\n  }\n  return value as string;\n}\n\n/**\n * 多选状态下选中内容\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getMultipleContent(cascaderContext: CascaderContextType) {\n  const { value, multiple, treeStore } = cascaderContext;\n\n  if (!multiple) return [];\n  if (multiple && !Array.isArray(value)) return [];\n\n  const node = treeStore && treeStore.getNodes(value as TreeNodeValue | TreeNode);\n  if (!node) return [];\n\n  const path = (value as TreeNodeValue[]).map((item: TreeNodeValue) => {\n    const node = treeStore.getNodes(item);\n    return node[0];\n  });\n  if (value && (value as TreeNodeValue[]).length) {\n    return path && path.length ? path : (value as TreeNode[]);\n  }\n  return [];\n}\n\n/**\n * 点击popup outside副作用\n * @param ref\n * @param cascaderContext\n * @param event\n * @returns\n */\nexport function outerClickListenerEffect(\n  ref: HTMLElement,\n  cascaderContext: CascaderContextType,\n  event: MouseEvent | TouchEvent,\n) {\n  const { visible, setVisible } = cascaderContext;\n  if (!ref || ref.contains(event.target as Node) || (event.target as HTMLElement)?.classList.contains('t-tag')) {\n    return;\n  }\n\n  if (visible) {\n    setVisible(false);\n  }\n}\n\n/**\n * closeIcon点击副作用\n * @param cascaderContext\n */\nexport function closeIconClickEffect(cascaderContext: CascaderContextType) {\n  const { setVisible, multiple, setExpend, setValue } = cascaderContext;\n\n  setVisible(false);\n\n  // 手动设置的展开需要去除\n  if (multiple) {\n    setExpend([]);\n  }\n\n  setValue(multiple ? [] : '', 'clear');\n}\n\n/**\n * tag 关闭按钮点击副作用\n * @param cascaderContext\n */\nexport function handleRemoveTagEffect(\n  cascaderContext: CascaderContextType,\n  node: TreeNode,\n  onRemove: CascaderProps['onRemove'],\n) {\n  const { disabled, setValue, valueType, treeStore } = cascaderContext;\n\n  if (disabled) return;\n  const checked = node.setChecked(!node.isChecked());\n  // 处理不同数据类型\n  const resValue =\n    valueType === 'single'\n      ? checked\n      : checked.map((val) =>\n          treeStore\n            .getNode(val)\n            .getPath()\n            .map((item) => item.value),\n        );\n\n  setValue(resValue, 'unchecked', node.getModel());\n  if (isFunction(onRemove)) {\n    onRemove({ value: checked, node: node as any });\n  }\n}\n\n/**\n * 外显content点击副作用\n * @param cascaderContext\n */\nexport function innerContentClickEffect(cascaderContext: CascaderContextType) {\n  const { setVisible, visible, filterActive, disabled } = cascaderContext;\n\n  if (!disabled) {\n    if (visible && filterActive) return; // input filter is active\n    setVisible(!visible);\n  }\n}\n"],"names":["getCloseIconClass","prefix","CLASSNAMES","cascaderContext","visible","disabled","STATUS","getFakeArrowIconClass","getCascaderInnerClasses","size","multiple","active","SIZE","getCloseShow","isHover","value","clearable","isEmpty","getPlaceholderShow","singleContent","multipleContent","filterable","valEmpty","length","getSingleContent","treeStore","showAllLevels","setValue","Array","isArray","node","getNodes","path","getPath","map","node2","label","join","getMultipleContent","item","outerClickListenerEffect","ref","event","setVisible","contains","target","classList","closeIconClickEffect","setExpend","handleRemoveTagEffect","onRemove","valueType","checked","setChecked","isChecked","resValue","val","getNode","getModel","isFunction","innerContentClickEffect","filterActive"],"mappings":"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"}