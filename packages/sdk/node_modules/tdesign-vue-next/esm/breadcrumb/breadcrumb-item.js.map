{"version":3,"file":"breadcrumb-item.js","sources":["../../src/breadcrumb/breadcrumb-item.tsx"],"sourcesContent":["import { defineComponent, ComponentPublicInstance, VNode } from 'vue';\nimport { ChevronRightIcon } from 'tdesign-icons-vue-next';\n\nimport { prefix } from '../config';\nimport props from './breadcrumb-item-props';\nimport Tooltip from '../tooltip/index';\nimport { isNodeOverflow } from '../utils/dom';\nimport { emitEvent } from '../utils/event';\nimport { getPropsApiByEvent } from '../utils/helper';\n\nconst separatorClass = `${prefix}-breadcrumb__separator`;\nconst disableClass = `${prefix}-disabled`;\nconst linkClass = `${prefix}-link`;\nconst maxLengthClass = `${prefix}-breadcrumb__inner`;\nconst textFlowClass = `${prefix}-breadcrumb--text-overflow`;\n\nexport const EVENT_NAME_WITH_KEBAB = ['click'];\ninterface LocalTBreadcrumb {\n  separator: (() => void) | string;\n  theme: string;\n  $slots: {\n    separator: VNode | string;\n  };\n  maxItemWidth: string;\n}\nconst localTBreadcrumbOrigin: LocalTBreadcrumb = {\n  separator: '',\n  theme: 'light',\n  $slots: { separator: '' },\n  maxItemWidth: undefined,\n};\n\nconst isEventProps = (propName: string): boolean => {\n  const pre = /on[A-Z].+/;\n  return pre.test(propName);\n};\n\nexport default defineComponent({\n  name: 'TBreadcrumbItem',\n  components: {\n    Tooltip,\n  },\n\n  inject: ['tBreadcrumb'],\n\n  props: {\n    ...props,\n  },\n\n  emits: ['click'],\n\n  data() {\n    return {\n      localTBreadcrumb: localTBreadcrumbOrigin,\n      themeClassName: '',\n      $router: null,\n      isCutOff: false,\n    };\n  },\n\n  computed: {\n    maxWithStyle() {\n      const { localTBreadcrumb } = this;\n      const { maxItemWidth } = localTBreadcrumb;\n      const maxWith: string = this.maxWidth || maxItemWidth || '120';\n      return { maxWidth: `${maxWith}px` };\n    },\n  },\n\n  watch: {\n    tBreadcrumb: {\n      immediate: true,\n      handler(v): void {\n        this.localTBreadcrumb = v;\n      },\n    },\n  },\n\n  created() {\n    const tBreadcrumb = this.localTBreadcrumb;\n    this.themeClassName = tBreadcrumb.theme;\n  },\n\n  mounted() {\n    this.isCutOff = isNodeOverflow(this.$refs.breadcrumbText as ComponentPublicInstance);\n  },\n  beforeUpdate() {\n    this.isCutOff = isNodeOverflow(this.$refs.breadcrumbText as ComponentPublicInstance);\n  },\n\n  methods: {\n    bindEvent(e: MouseEvent) {\n      if (!this.href || !this.disabled) {\n        e.preventDefault();\n        const { to } = this;\n        const router = this.router || this.$router;\n        if (to && router) {\n          this.replace ? router.replace(to) : router.push(to);\n        }\n      }\n    },\n  },\n\n  render() {\n    const { localTBreadcrumb, maxWithStyle } = this;\n    const { separator: separatorPropContent } = localTBreadcrumb;\n    const separatorSlot = localTBreadcrumb.$slots.separator;\n    const separatorContent = separatorPropContent || separatorSlot || (\n      <ChevronRightIcon {...{ color: 'rgba(0,0,0,.3)' }} />\n    );\n    const itemClass = [`${prefix}-breadcrumb__item`, this.themeClassName];\n    const textClass = [textFlowClass];\n\n    if (this.disabled) {\n      textClass.push(disableClass);\n    }\n    const listeners: Record<string, any> = {};\n    EVENT_NAME_WITH_KEBAB.forEach((eventName) => {\n      listeners[getPropsApiByEvent(eventName)] = (...args: any[]) => {\n        emitEvent(this, eventName, ...args);\n      };\n    });\n\n    const textContent = (\n      <span ref=\"breadcrumbText\" {...{ class: maxLengthClass, style: maxWithStyle }}>\n        {this.$slots.default()}\n      </span>\n    );\n    let itemContent = <span {...{ class: textClass, ...listeners }}>{textContent}</span>;\n\n    if ((this.href || this.to) && !this.disabled) {\n      textClass.push(linkClass);\n      itemContent = (\n        <a class={textClass} href={this.href} target={this.target} {...listeners} onClick={this.bindEvent}>\n          {textContent}\n        </a>\n      );\n    }\n\n    return (\n      <div class={itemClass} {...this.$attrs}>\n        {this.isCutOff ? <Tooltip content={() => this.$slots.default()}>{itemContent}</Tooltip> : itemContent}\n        <span class={separatorClass}>\n          {typeof separatorContent === 'function' ? separatorContent() : separatorContent}\n        </span>\n      </div>\n    );\n  },\n});\n"],"names":["separatorClass","prefix","disableClass","linkClass","maxLengthClass","textFlowClass","EVENT_NAME_WITH_KEBAB","localTBreadcrumbOrigin","separator","theme","$slots","maxItemWidth","isEventProps","propName","pre","test","defineComponent","name","components","Tooltip","inject","props","emits","data","localTBreadcrumb","themeClassName","$router","isCutOff","computed","maxWithStyle","maxWith","maxWidth","watch","tBreadcrumb","immediate","handler","v","created","mounted","isNodeOverflow","$refs","breadcrumbText","beforeUpdate","methods","bindEvent","e","href","disabled","preventDefault","to","router","replace","push","render","separatorPropContent","separatorSlot","separatorContent","color","itemClass","textClass","listeners","forEach","eventName","getPropsApiByEvent","args","emitEvent","textContent","style","itemContent","target","$attrs"],"mappings":"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"}