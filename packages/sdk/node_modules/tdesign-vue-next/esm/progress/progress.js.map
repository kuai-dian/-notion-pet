{"version":3,"file":"progress.js","sources":["../../src/progress/progress.tsx"],"sourcesContent":["import { defineComponent, VNode } from 'vue';\nimport {\n  CloseCircleFilledIcon,\n  CheckCircleFilledIcon,\n  ErrorCircleFilledIcon,\n  CloseIcon,\n  CheckIcon,\n  ErrorIcon,\n} from 'tdesign-icons-vue-next';\nimport { prefix } from '../config';\nimport { getBackgroundColor } from '../utils/helper';\nimport { PRO_THEME, CIRCLE_SIZE, CIRCLE_SIZE_PX, STATUS_ICON, CIRCLE_FONT_SIZE_RATIO } from './constants';\nimport props from './props';\n// import { RenderTNodeTemplate } from '../utils/render-tnode';\nimport { renderTNodeJSX } from '../utils/render-tnode';\nimport { Styles } from '../common';\n\nconst name = `${prefix}-progress`;\n\nexport default defineComponent({\n  name: 'TProgress',\n\n  props: { ...props },\n\n  data() {\n    return {\n      name,\n    };\n  },\n  computed: {\n    statusStyle(): string {\n      if (this.percentage >= 100) {\n        return 'success';\n      }\n      return this.status;\n    },\n    themeClass(): string {\n      const Line = PRO_THEME.LINE;\n      if (this.theme === Line) {\n        return 'thin';\n      }\n      return this.theme;\n    },\n    trackBgStyle(): Styles {\n      const { strokeWidth } = this;\n      const height = typeof strokeWidth === 'string' ? strokeWidth : `${strokeWidth}px`;\n      return {\n        height,\n        backgroundColor: this.trackColor,\n        borderRadius: height,\n      };\n    },\n    barStyle(): Styles {\n      return {\n        width: `${this.percentage}%`,\n        background: this.color && getBackgroundColor(this.color),\n      };\n    },\n    circlePathStyle(): Styles {\n      const strokeColor = typeof this.color === 'object' ? '' : this.color;\n      return {\n        stroke: strokeColor,\n      };\n    },\n    isShowIcon(): boolean {\n      return STATUS_ICON.includes(this.status) && typeof this.label === 'boolean';\n    },\n    // theme=circle 获取直径\n    diameter(): number {\n      let diameter = CIRCLE_SIZE_PX.MEDIUM;\n      if (!this.size) {\n        return diameter;\n      }\n      const { SMALL, LARGE, MEDIUM } = CIRCLE_SIZE;\n      switch (this.size) {\n        case SMALL:\n          diameter = CIRCLE_SIZE_PX.SMALL;\n          break;\n        case MEDIUM:\n          diameter = CIRCLE_SIZE_PX.MEDIUM;\n          break;\n        case LARGE:\n          diameter = CIRCLE_SIZE_PX.LARGE;\n          break;\n        default:\n          diameter = Number(this.size);\n          break;\n      }\n      return diameter;\n    },\n    rPoints(): number {\n      return this.diameter / 2;\n    },\n    radius(): number {\n      return this.rPoints - this.circleStrokeWidth / 2;\n    },\n    circleStyle(): Styles {\n      if (this.theme !== PRO_THEME.CIRCLE) {\n        return {};\n      }\n\n      let fontSize = this.diameter * CIRCLE_FONT_SIZE_RATIO.MEDIUM;\n      if (this.diameter <= CIRCLE_SIZE_PX.SMALL) {\n        fontSize = this.diameter * CIRCLE_FONT_SIZE_RATIO.SMALL;\n      } else if (this.diameter >= CIRCLE_SIZE_PX.LARGE) {\n        fontSize = this.diameter * CIRCLE_FONT_SIZE_RATIO.LARGE;\n      }\n\n      return {\n        width: `${this.diameter}px`,\n        height: `${this.diameter}px`,\n        fontSize: `${fontSize}px`,\n      };\n    },\n    // theme=circle 环形进度条 环形宽度\n    circleStrokeWidth(): number {\n      const defaultWidth = this.size === CIRCLE_SIZE.SMALL ? 4 : 6;\n      return this.strokeWidth ? Number(this.strokeWidth) : defaultWidth;\n    },\n    strokeDashArr(): string {\n      const radius = this.diameter / 2;\n      const perimeter = Math.PI * 2 * (radius - this.circleStrokeWidth);\n      const percent = this.percentage / 100;\n      return `${perimeter * percent}  ${perimeter * (1 - percent)}`;\n    },\n    plumpStyles(): Styles {\n      return {};\n      // return this.percentage > 10 ? { color: '#fff' } : { right: '-2.5rem' };\n    },\n  },\n\n  methods: {\n    getIconMap() {\n      const CIRCLE_ICONS = {\n        success: CheckIcon,\n        warning: ErrorIcon,\n        error: CloseIcon,\n      };\n      const NORMAL_ICONS = {\n        success: CheckCircleFilledIcon,\n        warning: ErrorCircleFilledIcon,\n        error: CloseCircleFilledIcon,\n      };\n      return this.theme === PRO_THEME.CIRCLE ? CIRCLE_ICONS : NORMAL_ICONS;\n    },\n    getLabelContent() {\n      let labelContent: string | VNode = `${this.percentage}%`;\n      const status = this.status || '';\n      if (STATUS_ICON.includes(status) && this.theme !== PRO_THEME.PLUMP) {\n        const components = this.getIconMap();\n        const component = components[status];\n        if (component) {\n          labelContent = <component class={[`${name}__icon`]}></component>;\n        }\n      }\n      return labelContent;\n    },\n  },\n\n  render() {\n    const labelContent = (\n      <div class={`${name}__info`}>{renderTNodeJSX(this, 'label', this.getLabelContent() as any)}</div>\n    );\n    // 进度大于 10 ，进度百分比显示在内部；进度百分比小于 10 进度显示在外部\n    const PLUMP_SEPERATE = 10;\n    const seperateClasses = this.percentage > PLUMP_SEPERATE ? `${name}--over-ten` : `${name}--under-ten`;\n    return (\n      <div class={name}>\n        {this.theme === PRO_THEME.LINE && (\n          <div class={`${name}--thin ${name}--status--${this.statusStyle}`}>\n            <div class={`${name}__bar`} style={this.trackBgStyle}>\n              <div class={`${name}__inner`} style={this.barStyle}></div>\n            </div>\n            {labelContent}\n          </div>\n        )}\n\n        {this.theme === PRO_THEME.PLUMP && (\n          <div\n            class={[\n              `${name}__bar ${name}--plump ${seperateClasses}`,\n              { [`${name}--status--${this.statusStyle}`]: this.statusStyle },\n            ]}\n            style={this.trackBgStyle}\n          >\n            <div class={`${name}__inner`} style={this.barStyle}>\n              {this.percentage > PLUMP_SEPERATE && labelContent}\n            </div>\n            {this.percentage < PLUMP_SEPERATE && labelContent}\n          </div>\n        )}\n\n        {this.theme === PRO_THEME.CIRCLE && (\n          <div class={`${name}--circle ${name}--status--${this.statusStyle}`} style={this.circleStyle}>\n            {labelContent}\n            <svg width={this.diameter} height={this.diameter} viewBox={`0 0 ${this.diameter} ${this.diameter}`}>\n              <circle\n                cx={this.rPoints}\n                cy={this.rPoints}\n                r={this.radius}\n                stroke-width={this.circleStrokeWidth}\n                stroke={this.trackColor}\n                fill=\"none\"\n                class={[`${name}__circle-outer`]}\n              />\n              <circle\n                cx={this.rPoints}\n                cy={this.rPoints}\n                r={this.radius}\n                stroke-width={this.circleStrokeWidth}\n                fill=\"none\"\n                stroke-linecap=\"round\"\n                class={[`${name}__circle-inner`]}\n                transform={`matrix(0,-1,1,0,0,${this.diameter})`}\n                stroke-dasharray={this.strokeDashArr}\n                style={this.circlePathStyle}\n              />\n            </svg>\n          </div>\n        )}\n      </div>\n    );\n  },\n});\n"],"names":["name","prefix","defineComponent","props","data","computed","statusStyle","percentage","status","themeClass","Line","PRO_THEME","LINE","theme","trackBgStyle","strokeWidth","height","backgroundColor","trackColor","borderRadius","barStyle","width","background","color","getBackgroundColor","circlePathStyle","strokeColor","stroke","isShowIcon","STATUS_ICON","includes","label","diameter","CIRCLE_SIZE_PX","MEDIUM","size","SMALL","CIRCLE_SIZE","LARGE","Number","rPoints","radius","circleStrokeWidth","circleStyle","CIRCLE","fontSize","CIRCLE_FONT_SIZE_RATIO","defaultWidth","strokeDashArr","perimeter","Math","PI","percent","plumpStyles","methods","getIconMap","CIRCLE_ICONS","success","CheckIcon","warning","ErrorIcon","error","CloseIcon","NORMAL_ICONS","CheckCircleFilledIcon","ErrorCircleFilledIcon","CloseCircleFilledIcon","getLabelContent","labelContent","PLUMP","components","component","render","renderTNodeJSX","PLUMP_SEPERATE","seperateClasses"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAcA,IAAMA,IAAI,aAAMC,MAAN,cAAV;AACA,gBAAeC,eAAe,CAAC;AAC7BF,EAAAA,IAAI,EAAE,WADuB;AAE7BG,EAAAA,KAAK,oBAAOA,KAAP,CAFwB;AAG7BC,EAAAA,IAH6B,kBAGtB;AACL,WAAO;AACLJ,MAAAA,IAAI,EAAJA;AADK,KAAP;AAGD,GAP4B;AAQ7BK,EAAAA,QAAQ,EAAE;AACRC,IAAAA,WADQ,yBACM;AACZ,UAAI,KAAKC,UAAL,IAAmB,GAAvB,EAA4B;AAC1B,eAAO,SAAP;AACD;;AACD,aAAO,KAAKC,MAAZ;AACD,KANO;AAORC,IAAAA,UAPQ,wBAOK;AACX,UAAMC,IAAI,GAAGC,SAAS,CAACC,IAAvB;;AACA,UAAI,KAAKC,KAAL,KAAeH,IAAnB,EAAyB;AACvB,eAAO,MAAP;AACD;;AACD,aAAO,KAAKG,KAAZ;AACD,KAbO;AAcRC,IAAAA,YAdQ,0BAcO;AACb,UAAQC,WAAR,GAAwB,IAAxB,CAAQA,WAAR;AACA,UAAMC,MAAM,GAAG,OAAOD,WAAP,KAAuB,QAAvB,GAAkCA,WAAlC,aAAmDA,WAAnD,OAAf;AACA,aAAO;AACLC,QAAAA,MAAM,EAANA,MADK;AAELC,QAAAA,eAAe,EAAE,KAAKC,UAFjB;AAGLC,QAAAA,YAAY,EAAEH;AAHT,OAAP;AAKD,KAtBO;AAuBRI,IAAAA,QAvBQ,sBAuBG;AACT,aAAO;AACLC,QAAAA,KAAK,YAAK,KAAKd,UAAV,MADA;AAELe,QAAAA,UAAU,EAAE,KAAKC,KAAL,IAAcC,kBAAkB,CAAC,KAAKD,KAAN;AAFvC,OAAP;AAID,KA5BO;AA6BRE,IAAAA,eA7BQ,6BA6BU;AAChB,UAAMC,WAAW,GAAG,QAAO,KAAKH,KAAZ,MAAsB,QAAtB,GAAiC,EAAjC,GAAsC,KAAKA,KAA/D;AACA,aAAO;AACLI,QAAAA,MAAM,EAAED;AADH,OAAP;AAGD,KAlCO;AAmCRE,IAAAA,UAnCQ,wBAmCK;AACX,aAAOC,WAAW,CAACC,QAAZ,CAAqB,KAAKtB,MAA1B,KAAqC,OAAO,KAAKuB,KAAZ,KAAsB,SAAlE;AACD,KArCO;AAsCRC,IAAAA,QAtCQ,sBAsCG;AACT,UAAIA,QAAQ,GAAGC,cAAc,CAACC,MAA9B;;AACA,UAAI,CAAC,KAAKC,IAAV,EAAgB;AACd,eAAOH,QAAP;AACD;;AACD,UAAQI,KAAR,GAAiCC,WAAjC,CAAQD,KAAR;AAAA,UAAeE,KAAf,GAAiCD,WAAjC,CAAeC,KAAf;AAAA,UAAsBJ,MAAtB,GAAiCG,WAAjC,CAAsBH,MAAtB;;AACA,cAAQ,KAAKC,IAAb;AACE,aAAKC,KAAL;AACEJ,UAAAA,QAAQ,GAAGC,cAAc,CAACG,KAA1B;AACA;;AACF,aAAKF,MAAL;AACEF,UAAAA,QAAQ,GAAGC,cAAc,CAACC,MAA1B;AACA;;AACF,aAAKI,KAAL;AACEN,UAAAA,QAAQ,GAAGC,cAAc,CAACK,KAA1B;AACA;;AACF;AACEN,UAAAA,QAAQ,GAAGO,MAAM,CAAC,KAAKJ,IAAN,CAAjB;AACA;AAZJ;;AAcA,aAAOH,QAAP;AACD,KA3DO;AA4DRQ,IAAAA,OA5DQ,qBA4DE;AACR,aAAO,KAAKR,QAAL,GAAgB,CAAvB;AACD,KA9DO;AA+DRS,IAAAA,MA/DQ,oBA+DC;AACP,aAAO,KAAKD,OAAL,GAAe,KAAKE,iBAAL,GAAyB,CAA/C;AACD,KAjEO;AAkERC,IAAAA,WAlEQ,yBAkEM;AACZ,UAAI,KAAK9B,KAAL,KAAeF,SAAS,CAACiC,MAA7B,EAAqC;AACnC,eAAO,EAAP;AACD;;AACD,UAAIC,QAAQ,GAAG,KAAKb,QAAL,GAAgBc,sBAAsB,CAACZ,MAAtD;;AACA,UAAI,KAAKF,QAAL,IAAiBC,cAAc,CAACG,KAApC,EAA2C;AACzCS,QAAAA,QAAQ,GAAG,KAAKb,QAAL,GAAgBc,sBAAsB,CAACV,KAAlD;AACD,OAFD,MAEO,IAAI,KAAKJ,QAAL,IAAiBC,cAAc,CAACK,KAApC,EAA2C;AAChDO,QAAAA,QAAQ,GAAG,KAAKb,QAAL,GAAgBc,sBAAsB,CAACR,KAAlD;AACD;;AACD,aAAO;AACLjB,QAAAA,KAAK,YAAK,KAAKW,QAAV,OADA;AAELhB,QAAAA,MAAM,YAAK,KAAKgB,QAAV,OAFD;AAGLa,QAAAA,QAAQ,YAAKA,QAAL;AAHH,OAAP;AAKD,KAjFO;AAkFRH,IAAAA,iBAlFQ,+BAkFY;AAClB,UAAMK,YAAY,GAAG,KAAKZ,IAAL,KAAcE,WAAW,CAACD,KAA1B,GAAkC,CAAlC,GAAsC,CAA3D;AACA,aAAO,KAAKrB,WAAL,GAAmBwB,MAAM,CAAC,KAAKxB,WAAN,CAAzB,GAA8CgC,YAArD;AACD,KArFO;AAsFRC,IAAAA,aAtFQ,2BAsFQ;AACd,UAAMP,MAAM,GAAG,KAAKT,QAAL,GAAgB,CAA/B;AACA,UAAMiB,SAAS,GAAGC,IAAI,CAACC,EAAL,GAAU,CAAV,IAAeV,MAAM,GAAG,KAAKC,iBAA7B,CAAlB;AACA,UAAMU,OAAO,GAAG,KAAK7C,UAAL,GAAkB,GAAlC;AACA,uBAAU0C,SAAS,GAAGG,OAAtB,eAAkCH,SAAS,IAAI,IAAIG,OAAR,CAA3C;AACD,KA3FO;AA4FRC,IAAAA,WA5FQ,yBA4FM;AACZ,aAAO,EAAP;AACD;AA9FO,GARmB;AAwG7BC,EAAAA,OAAO,EAAE;AACPC,IAAAA,UADO,wBACM;AACX,UAAMC,YAAY,GAAG;AACnBC,QAAAA,OAAO,EAAEC,SADU;AAEnBC,QAAAA,OAAO,EAAEC,SAFU;AAGnBC,QAAAA,KAAK,EAAEC;AAHY,OAArB;AAKA,UAAMC,YAAY,GAAG;AACnBN,QAAAA,OAAO,EAAEO,qBADU;AAEnBL,QAAAA,OAAO,EAAEM,qBAFU;AAGnBJ,QAAAA,KAAK,EAAEK;AAHY,OAArB;AAKA,aAAO,KAAKrD,KAAL,KAAeF,SAAS,CAACiC,MAAzB,GAAkCY,YAAlC,GAAiDO,YAAxD;AACD,KAbM;AAcPI,IAAAA,eAdO,6BAcW;AAChB,UAAIC,YAAY,aAAM,KAAK7D,UAAX,MAAhB;AACA,UAAMC,MAAM,GAAG,KAAKA,MAAL,IAAe,EAA9B;;AACA,UAAIqB,WAAW,CAACC,QAAZ,CAAqBtB,MAArB,KAAgC,KAAKK,KAAL,KAAeF,SAAS,CAAC0D,KAA7D,EAAoE;AAClE,YAAMC,UAAU,GAAG,KAAKf,UAAL,EAAnB;AACA,YAAMgB,SAAS,GAAGD,UAAU,CAAC9D,MAAD,CAA5B;;AACA,YAAI+D,SAAJ,EAAe;AACbH,UAAAA,YAAY;AAAA,qBAAqB,WAAIpE,IAAJ;AAArB,kBAAZ;AACD;AACF;;AACD,aAAOoE,YAAP;AACD;AAzBM,GAxGoB;AAmI7BI,EAAAA,MAnI6B,oBAmIpB;AACP,QAAMJ,YAAY;AAAA,yBAAkBpE,IAAlB;AAAA,QAAiCyE,cAAc,CAAC,IAAD,EAAO,OAAP,EAAgB,KAAKN,eAAL,EAAhB,CAA/C,EAAlB;;AACA,QAAMO,cAAc,GAAG,EAAvB;AACA,QAAMC,eAAe,GAAG,KAAKpE,UAAL,GAAkBmE,cAAlB,aAAsC1E,IAAtC,4BAA4DA,IAA5D,gBAAxB;AACA;AAAA,eAAmBA;AAAnB,QACG,KAAKa,KAAL,KAAeF,SAAS,CAACC,IAAzB;AAAA,yBAAgDZ,IAAhD,oBAA8DA,IAA9D,uBAA+E,KAAKM,WAApF;AAAA;AAAA,yBACgBN,IADhB;AAAA,eACoC,KAAKc;AADzC;AAAA,yBACsEd,IADtE;AAAA,eAC4F,KAAKoB;AADjG,gBAEEgD,YAFF,EADH,EAKG,KAAKvD,KAAL,KAAeF,SAAS,CAAC0D,KAAzB;AAAA,eAA8C,WAC1CrE,IAD0C,mBAC7BA,IAD6B,qBACd2E,eADc,iCAEvC3E,IAFuC,uBAEtB,KAAKM,WAFiB,GAED,KAAKA,WAFJ,EAA9C;AAAA,eAGS,KAAKQ;AAHd;AAAA,yBAIgBd,IAJhB;AAAA,eAIsC,KAAKoB;AAJ3C,QAIsD,KAAKb,UAAL,GAAkBmE,cAAlB,IAAoCN,YAJ1F,IAKE,KAAK7D,UAAL,GAAkBmE,cAAlB,IAAoCN,YALtC,EALH,EAYG,KAAKvD,KAAL,KAAeF,SAAS,CAACiC,MAAzB;AAAA,yBAAkD5C,IAAlD,sBAAkEA,IAAlE,uBAAmF,KAAKM,WAAxF;AAAA,eAA8G,KAAKqC;AAAnH,QACEyB,YADF;AAAA,eAEa,KAAKpC,QAFlB;AAAA,gBAEoC,KAAKA,QAFzC;AAAA,+BAEmE,KAAKA,QAFxE,cAEoF,KAAKA,QAFzF;AAAA;AAAA,YAGe,KAAKQ,OAHpB;AAAA,YAGiC,KAAKA,OAHtC;AAAA,WAGkD,KAAKC,MAHvD;AAAA,sBAG6E,KAAKC,iBAHlF;AAAA,gBAG6G,KAAKxB,UAHlH;AAAA,cAGmI,MAHnI;AAAA,eAGiJ,WAAIlB,IAAJ;AAHjJ;AAAA,YAIe,KAAKwC,OAJpB;AAAA,YAIiC,KAAKA,OAJtC;AAAA,WAIkD,KAAKC,MAJvD;AAAA,sBAI6E,KAAKC,iBAJlF;AAAA,cAI0G,MAJ1G;AAAA,wBAIgI,OAJhI;AAAA,eAI+I,WAAI1C,IAAJ,oBAJ/I;AAAA,+CAI0M,KAAKgC,QAJ/M;AAAA,0BAI8O,KAAKgB,aAJnP;AAAA,eAIyQ,KAAKvB;AAJ9Q,gBAZH;AAoBD;AA3J4B,CAAD,CAA9B;;;;"}