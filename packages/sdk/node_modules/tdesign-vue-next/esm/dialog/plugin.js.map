{"version":3,"file":"plugin.js","sources":["../../src/dialog/plugin.tsx"],"sourcesContent":["import { App, createApp, ref, Plugin, defineComponent, h } from 'vue';\nimport DialogComponent from './dialog';\nimport { getAttach } from '../utils/dom';\nimport { DialogOptions, DialogMethod, DialogConfirmMethod, DialogAlertMethod, DialogInstance } from './type';\n\nconst createDialog: DialogMethod = (props: DialogOptions) => {\n  const options = { ...props };\n  const wrapper = document.createElement('div');\n  const visible = ref(true);\n  const { className } = options;\n  const component = defineComponent({\n    data() {\n      return {\n        dialogOptions: options as Record<string, any>,\n      };\n    },\n    render() {\n      const onClose =\n        options.onClose ||\n        function () {\n          visible.value = false;\n        };\n      delete options.className;\n      return h(DialogComponent, {\n        onClose,\n        visible: visible.value,\n        ...this.dialogOptions,\n      });\n    },\n  });\n  const dialog = createApp(component).mount(wrapper);\n\n  if (className) {\n    className.split(' ').forEach((name) => {\n      dialog.$el.classList.add(name.trim());\n    });\n  }\n  if (options.style) {\n    (dialog.$el as HTMLElement).style.cssText += options.style;\n  }\n\n  const container = getAttach(options.attach);\n  if (container) {\n    container.appendChild(wrapper);\n  } else {\n    console.error('attach is not exist');\n  }\n\n  const dialogNode: DialogInstance = {\n    show: () => {\n      visible.value = true;\n    },\n    hide: () => {\n      visible.value = false;\n    },\n    update: (options: DialogOptions) => {\n      Object.assign(dialog, { dialogOptions: options });\n    },\n    destroy: () => {\n      visible.value = false;\n    },\n  };\n  return dialogNode;\n};\ninterface ExtraApi {\n  confirm: DialogConfirmMethod;\n  alert: DialogAlertMethod;\n}\n\nconst confirm: DialogConfirmMethod = (props: DialogOptions) => createDialog(props);\n\nconst alert: DialogAlertMethod = (props: Omit<DialogOptions, 'confirmBtn'>) => {\n  const options = { ...props };\n  options.cancelBtn = null;\n  return createDialog(options);\n};\n\nconst extraApi: ExtraApi = {\n  confirm,\n  alert,\n};\n\nexport type DialogPluginType = Plugin & ExtraApi & DialogAlertMethod;\n\nconst DialogPlugin: DialogPluginType = createDialog as DialogPluginType;\n\nDialogPlugin.install = (app: App): void => {\n  app.config.globalProperties.$dialog = createDialog;\n  Object.keys(extraApi).forEach((funcName) => {\n    app.config.globalProperties.$dialog[funcName] = extraApi[funcName];\n  });\n};\n\nObject.keys(extraApi).forEach((funcName) => {\n  DialogPlugin[funcName] = extraApi[funcName];\n});\n\nexport default DialogPlugin;\n"],"names":["createDialog","props","options","wrapper","document","createElement","visible","ref","className","component","defineComponent","data","dialogOptions","render","onClose","value","h","DialogComponent","dialog","createApp","mount","split","forEach","name","$el","classList","add","trim","style","cssText","container","getAttach","attach","appendChild","console","error","dialogNode","show","hide","update","options2","Object","assign","destroy","confirm","alert","cancelBtn","extraApi","DialogPlugin","install","app","config","globalProperties","$dialog","keys","funcName"],"mappings":"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"}