{"version":3,"file":"anchor-item.js","sources":["../../src/anchor/anchor-item.tsx"],"sourcesContent":["import { defineComponent, h, VNodeChild } from 'vue';\nimport { prefix } from '../config';\nimport CLASSNAMES from '../utils/classnames';\nimport { ANCHOR_SHARP_REGEXP } from './utils';\nimport props from './anchor-item-props';\nimport { COMPONENT_NAME } from './constant';\n\nconst CLASSNAME_PREFIX = `${COMPONENT_NAME}__item`;\n\nexport default defineComponent({\n  name: 'TAnchorItem',\n  inject: {\n    tAnchor: { default: undefined },\n  },\n  props: {\n    ...props,\n    href: {\n      type: String,\n      required: true,\n      validator(v: string): boolean {\n        return ANCHOR_SHARP_REGEXP.test(v);\n      },\n    },\n  },\n  watch: {\n    href: {\n      immediate: true,\n      handler() {\n        this.unregister();\n        this.register();\n      },\n    },\n  },\n  mounted() {\n    this.register();\n  },\n  unmounted() {\n    this.unregister();\n  },\n  methods: {\n    register(): void {\n      this.tAnchor.registerLink(this.href as string);\n    },\n    unregister(): void {\n      const { href } = this;\n      if (!href) return;\n      this.tAnchor.unregisterLink(href);\n    },\n    handleClick(e: MouseEvent): void {\n      const { href, tAnchor, title } = this;\n      tAnchor.handleScrollTo(href);\n      tAnchor.handleLinkClick(\n        {\n          href,\n          title: typeof title === 'string' ? title : undefined,\n        },\n        e,\n      );\n    },\n    renderTitle() {\n      const { title, $slots } = this;\n      const { title: titleSlot } = $slots;\n      let titleVal: VNodeChild;\n      if (typeof title === 'string') {\n        titleVal = title;\n      } else if (typeof title === 'function') {\n        titleVal = title(h);\n      } else if (titleSlot) {\n        titleVal = titleSlot(null);\n      }\n      return titleVal;\n    },\n  },\n  render() {\n    const { href, target, $slots, tAnchor } = this;\n    const { default: children, title: titleSlot } = $slots;\n    const title = this.renderTitle();\n    const titleAttr = typeof title === 'string' ? title : null;\n    const active = tAnchor.active === href;\n    const wrapperClass = {\n      [CLASSNAME_PREFIX]: true,\n      [CLASSNAMES.STATUS.active]: active,\n    };\n    const titleClass = {\n      [`${CLASSNAME_PREFIX}-link`]: true,\n    };\n    return (\n      <div class={wrapperClass}>\n        <a href={href} title={titleAttr} class={titleClass} target={target} onClick={this.handleClick}>\n          {titleSlot ? titleSlot(null) : title}\n        </a>\n        {children && children(null)}\n      </div>\n    );\n  },\n});\n"],"names":["CLASSNAME_PREFIX","COMPONENT_NAME","defineComponent","name","inject","tAnchor","props","href","type","String","required","validator","v","ANCHOR_SHARP_REGEXP","test","watch","immediate","handler","unregister","register","mounted","unmounted","methods","registerLink","unregisterLink","handleClick","e","title","handleScrollTo","handleLinkClick","renderTitle","$slots","titleSlot","titleVal","h","render","target","children","titleAttr","active","wrapperClass","CLASSNAMES","STATUS","titleClass"],"mappings":"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"}