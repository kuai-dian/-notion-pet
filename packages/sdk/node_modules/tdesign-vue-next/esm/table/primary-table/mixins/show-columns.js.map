{"version":3,"file":"show-columns.js","sources":["../../../../src/table/primary-table/mixins/show-columns.tsx"],"sourcesContent":["import { defineComponent, VNode } from 'vue';\nimport { BulletpointIcon } from 'tdesign-icons-vue-next';\nimport Button from '../../../button';\nimport Dialog from '../../../dialog';\nimport Checkbox from '../../../checkbox';\nimport CheckboxGroup from '../../../checkbox/group';\nimport primaryTableProps from '../../primary-table-props';\nimport { TdPrimaryTableProps } from '../../type';\nimport { prefix } from '../../../config';\n\nconst content = '自定义列';\nexport default defineComponent({\n  name: `${prefix}-primary-show-columns`,\n  components: {\n    Button,\n    BulletpointIcon,\n    Dialog,\n    Checkbox,\n    CheckboxGroup,\n  },\n  props: {\n    columns: primaryTableProps.columns,\n    showColumns: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  data() {\n    return {\n      showColumnKeys: this.columns.map(({ colKey }) => colKey), // dialog 确定后才重新赋值\n      showColumnCheckboxKeys: this.columns.map(({ colKey }) => colKey), // 多选框状态\n      isShowColumnsDlg: false,\n    };\n  },\n  computed: {\n    showColumnCheckboxOpts(): Record<string, any>[] {\n      return this.columns\n        .filter(({ colKey, title }) => colKey && title) // 去空\n        .map(({ colKey, title }) => ({\n          label: title,\n          value: colKey,\n        }));\n    },\n    isAllShowColumns(): boolean {\n      return this.showColumnCheckboxOpts.every(({ value }: Record<string, any>) =>\n        this.showColumnCheckboxKeys.includes(value),\n      );\n    },\n    isSomeShowColumns(): boolean {\n      return (\n        !this.isAllShowColumns &&\n        this.showColumnCheckboxOpts.some(({ value }: Record<string, any>) =>\n          this.showColumnCheckboxKeys.includes(value),\n        )\n      );\n    },\n  },\n  watch: {\n    columns: {\n      deep: true,\n      handler() {\n        this.updateColumns();\n      },\n    },\n  },\n  methods: {\n    getShowColumns(columns: TdPrimaryTableProps['columns']): TdPrimaryTableProps['columns'] {\n      return columns.filter(\n        ({ colKey }) =>\n          this.showColumnKeys.includes(colKey) ||\n          !this.showColumnCheckboxOpts.map(({ value }: Record<string, any>) => value).includes(colKey),\n      );\n    },\n\n    renderShowColumnsDlgFooter(): VNode {\n      return (\n        <div>\n          <Button variant=\"base\" theme=\"primary\" onClick={this.handleConfirmShowColumnsDlg}>\n            确定\n          </Button>\n          <Button onClick={this.handleConfirmShowColumnsDlg}>取消</Button>\n        </div>\n      );\n    },\n    renderShowColumnsDlg(): VNode {\n      return (\n        <Dialog header={content} footer={this.renderShowColumnsDlgFooter} visible={this.isShowColumnsDlg}>\n          <div slot=\"body\">\n            <div>\n              <Checkbox\n                indeterminate={this.isSomeShowColumns}\n                checked={this.isAllShowColumns}\n                onChange={this.handleClickAllShowColumns}\n              >\n                全选\n              </Checkbox>\n            </div>\n            <CheckboxGroup options={this.showColumnCheckboxOpts} vModel={this.showColumnCheckboxKeys} />\n          </div>\n        </Dialog>\n      );\n    },\n    renderShowColumns(): VNode {\n      return (\n        <div>\n          <div>\n            <Button icon={() => <BulletpointIcon />} onClick={() => (this.isShowColumnsDlg = true)}>\n              {content}\n            </Button>\n          </div>\n          {this.renderShowColumnsDlg()}\n        </div>\n      );\n    },\n\n    handleClickAllShowColumns(): void {\n      this.showColumnCheckboxKeys = this.isAllShowColumns\n        ? []\n        : this.showColumnCheckboxOpts.map(({ value }: Record<string, any>) => value);\n    },\n    handleConfirmShowColumnsDlg(): void {\n      this.showColumnKeys = [...this.showColumnCheckboxKeys];\n      this.handleCancelShowColumnsDlg();\n    },\n    handleCancelShowColumnsDlg(): void {\n      this.isShowColumnsDlg = false;\n    },\n    updateColumns(): void {\n      this.showColumnKeys = this.columns.map(({ colKey }) => colKey);\n      this.showColumnCheckboxKeys = this.columns.map(({ colKey }) => colKey);\n    },\n  },\n});\n"],"names":["content","defineComponent","name","prefix","components","Button","BulletpointIcon","Dialog","Checkbox","CheckboxGroup","props","columns","primaryTableProps","showColumns","type","Boolean","data","showColumnKeys","map","colKey","showColumnCheckboxKeys","isShowColumnsDlg","computed","showColumnCheckboxOpts","filter","title","label","value","isAllShowColumns","every","includes","isSomeShowColumns","some","watch","deep","handler","updateColumns","methods","getShowColumns","renderShowColumnsDlgFooter","handleConfirmShowColumnsDlg","renderShowColumnsDlg","handleClickAllShowColumns","renderShowColumns","handleCancelShowColumnsDlg"],"mappings":"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"}