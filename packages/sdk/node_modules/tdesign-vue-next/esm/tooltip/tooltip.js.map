{"version":3,"file":"tooltip.js","sources":["../../src/tooltip/tooltip.tsx"],"sourcesContent":["import { defineComponent } from 'vue';\nimport { prefix } from '../config';\nimport props from './props';\nimport popupProps from '../popup/props';\nimport Popup, { PopupProps, PopupVisibleChangeContext } from '../popup';\nimport { ClassName } from '../common';\nimport { renderTNodeJSX, renderContent } from '../utils/render-tnode';\nimport { emitEvent } from '../utils/event';\n\nexport default defineComponent({\n  name: 'TTooltip',\n  components: { Popup },\n  props: {\n    ...popupProps,\n    ...props,\n  },\n  emits: ['visible-change'],\n  data() {\n    return {\n      timer: null,\n      tooltipVisible: false,\n    };\n  },\n  computed: {\n    tooltipOverlayClassName(): ClassName {\n      return [`${prefix}-tooltip`, { [`${prefix}-tooltip--${this.theme}`]: this.theme }, this.overlayClassName];\n    },\n  },\n  watch: {\n    visible(visible) {\n      if (this.timer && !visible) {\n        clearTimeout(this.timer);\n        this.timer = null;\n      }\n    },\n  },\n  created() {\n    if (this.duration && this.visible) {\n      this.timer = setTimeout(() => {\n        emitEvent(this, 'visible-change', false);\n        clearTimeout(this.timer);\n        this.timer = null;\n      }, this.duration);\n    }\n  },\n  methods: {\n    onTipVisibleChange(val: boolean, ctx?: PopupVisibleChangeContext) {\n      // 因 props={this.getPopupProps()} 已经透传 onVisibleChange props，此处不再需要使用 emitEvent\n      if (this.timer && ctx?.trigger !== 'document') return;\n      emitEvent(this, 'visible-change', val);\n    },\n\n    getPopupProps(): PopupProps {\n      const r: PopupProps = {\n        showArrow: true,\n        ...this.$props,\n        content: () => renderTNodeJSX(this, 'content'),\n        default: () => renderContent(this, 'default', 'triggerElement'),\n        overlayClassName: this.tooltipOverlayClassName,\n        onVisibleChange: this.onTipVisibleChange,\n      };\n      return r;\n    },\n  },\n  render() {\n    return <Popup visible={this.visible} showArrow={this.showArrow} {...this.getPopupProps()} />;\n  },\n});\n"],"names":["defineComponent","name","components","Popup","props","popupProps","emits","data","timer","tooltipVisible","computed","tooltipOverlayClassName","prefix","theme","overlayClassName","watch","visible","clearTimeout","created","duration","setTimeout","emitEvent","methods","onTipVisibleChange","val","ctx","trigger","getPopupProps","r","showArrow","$props","content","renderTNodeJSX","renderContent","onVisibleChange","render"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOA,eAAeA,eAAe,CAAC;AAC7BC,EAAAA,IAAI,EAAE,UADuB;AAE7BC,EAAAA,UAAU,EAAE;AAAEC,IAAAA,KAAK,EAALA;AAAF,GAFiB;AAG7BC,EAAAA,KAAK,kCACAC,UADA,GAEAD,KAFA,CAHwB;AAO7BE,EAAAA,KAAK,EAAE,CAAC,gBAAD,CAPsB;AAQ7BC,EAAAA,IAR6B,kBAQtB;AACL,WAAO;AACLC,MAAAA,KAAK,EAAE,IADF;AAELC,MAAAA,cAAc,EAAE;AAFX,KAAP;AAID,GAb4B;AAc7BC,EAAAA,QAAQ,EAAE;AACRC,IAAAA,uBADQ,qCACkB;AACxB,aAAO,WAAIC,MAAJ,6CAA4BA,MAA5B,uBAA+C,KAAKC,KAApD,GAA8D,KAAKA,KAAnE,GAA4E,KAAKC,gBAAjF,CAAP;AACD;AAHO,GAdmB;AAmB7BC,EAAAA,KAAK,EAAE;AACLC,IAAAA,OADK,mBACGA,QADH,EACY;AACf,UAAI,KAAKR,KAAL,IAAc,CAACQ,QAAnB,EAA4B;AAC1BC,QAAAA,YAAY,CAAC,KAAKT,KAAN,CAAZ;AACA,aAAKA,KAAL,GAAa,IAAb;AACD;AACF;AANI,GAnBsB;AA2B7BU,EAAAA,OA3B6B,qBA2BnB;AAAA;;AACR,QAAI,KAAKC,QAAL,IAAiB,KAAKH,OAA1B,EAAmC;AACjC,WAAKR,KAAL,GAAaY,UAAU,CAAC,YAAM;AAC5BC,QAAAA,SAAS,CAAC,KAAD,EAAO,gBAAP,EAAyB,KAAzB,CAAT;AACAJ,QAAAA,YAAY,CAAC,KAAI,CAACT,KAAN,CAAZ;AACA,QAAA,KAAI,CAACA,KAAL,GAAa,IAAb;AACD,OAJsB,EAIpB,KAAKW,QAJe,CAAvB;AAKD;AACF,GAnC4B;AAoC7BG,EAAAA,OAAO,EAAE;AACPC,IAAAA,kBADO,8BACYC,GADZ,EACiBC,GADjB,EACsB;AAC3B,UAAI,KAAKjB,KAAL,IAAc,CAAAiB,GAAG,SAAH,IAAAA,GAAG,WAAH,YAAAA,GAAG,CAAEC,OAAL,MAAiB,UAAnC,EACE;AACFL,MAAAA,SAAS,CAAC,IAAD,EAAO,gBAAP,EAAyBG,GAAzB,CAAT;AACD,KALM;AAMPG,IAAAA,aANO,2BAMS;AAAA;;AACd,UAAMC,CAAC;AACLC,QAAAA,SAAS,EAAE;AADN,SAEF,KAAKC,MAFH;AAGLC,QAAAA,OAAO,EAAE;AAAA,iBAAMC,cAAc,CAAC,MAAD,EAAO,SAAP,CAApB;AAAA,SAHJ;AAIL,mBAAS;AAAA,iBAAMC,aAAa,CAAC,MAAD,EAAO,SAAP,EAAkB,gBAAlB,CAAnB;AAAA,SAJJ;AAKLnB,QAAAA,gBAAgB,EAAE,KAAKH,uBALlB;AAMLuB,QAAAA,eAAe,EAAE,KAAKX;AANjB,QAAP;;AAQA,aAAOK,CAAP;AACD;AAhBM,GApCoB;AAsD7BO,EAAAA,MAtD6B,oBAsDpB;AACP;AAAA,iBAAuB,KAAKnB,OAA5B;AAAA,mBAAgD,KAAKa;AAArD,OAAoE,KAAKF,aAAL,EAApE;AACD;AAxD4B,CAAD,CAA9B;;;;"}