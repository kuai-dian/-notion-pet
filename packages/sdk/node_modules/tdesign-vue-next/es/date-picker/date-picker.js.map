{"version":3,"file":"date-picker.js","sources":["../../node_modules/dayjs/plugin/isBetween.js","../../src/date-picker/date-picker.tsx"],"sourcesContent":["!function(e,i){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=i():\"function\"==typeof define&&define.amd?define(i):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_isBetween=i()}(this,(function(){\"use strict\";return function(e,i,t){i.prototype.isBetween=function(e,i,s,f){var n=t(e),o=t(i),r=\"(\"===(f=f||\"()\")[0],u=\")\"===f[1];return(r?this.isAfter(n,s):!this.isBefore(n,s))&&(u?this.isBefore(o,s):!this.isAfter(o,s))||(r?this.isBefore(n,s):!this.isAfter(n,s))&&(u?this.isAfter(o,s):!this.isBefore(o,s))}}}));","import { ComponentPublicInstance, defineComponent, nextTick } from 'vue';\nimport dayjs from 'dayjs';\nimport isBetween from 'dayjs/plugin/isBetween';\nimport { CalendarIcon, TimeIcon } from 'tdesign-icons-vue-next';\nimport debounce from 'lodash/debounce';\nimport { emitEvent } from '../utils/event';\n\nimport { prefix } from '../config';\nimport props from './props';\nimport CLASSNAMES from '../utils/classnames';\n\nimport { Button as TButton } from '../button';\nimport { Input as TInput } from '../input';\nimport TPopup from '../popup';\nimport mixins from '../utils/mixins';\nimport getConfigReceiverMixins, { DatePickerConfig } from '../config-provider/config-receiver';\n\nimport TCalendarPresets from './calendar-presets';\nimport TDate from './panel/date';\nimport TDateRange from './panel/date-range';\nimport TTimePickerPanel from '../time-picker/panel';\nimport { EPickerCols } from '../time-picker/constant';\nimport { firstUpperCase, extractTimeFormat } from '../_common/js/date-picker/utils';\nimport { DateValue, PickContext } from './interface';\nimport { renderTNodeJSX } from '../utils/render-tnode';\n\ndayjs.extend(isBetween);\n\nconst onOpenDebounce = debounce((vm?: any) => {\n  vm.createPopover();\n}, 250);\n\nconst name = `${prefix}-date-picker`;\n\nexport default defineComponent({\n  ...mixins(getConfigReceiverMixins<DatePickerConfig>('datePicker')),\n  name: 'TDatePicker',\n  components: {\n    TPopup,\n    TButton,\n    TInput,\n    TCalendarPresets,\n    TDate,\n    TDateRange,\n    TTimePickerPanel,\n  },\n  props,\n  emits: ['input', 'open', 'close', 'focus', 'click', 'change', 'pick'],\n  data() {\n    return {\n      tempValue: '' as string | number | dayjs.Dayjs | Date,\n      monthDate: new Date(),\n      start: new Date(),\n      end: new Date(),\n      selectedDates: [],\n      inSelection: false,\n      inline: false,\n      dateFormat: '',\n      multiSeparator: ',',\n      inlineView: false,\n      showTime: false,\n      isOpen: false,\n      startTimeValue: dayjs(),\n      endTimeValue: dayjs(),\n    };\n  },\n  computed: {\n    startText(): string {\n      return this.formatDate(this.start as Date);\n    },\n    endText(): string {\n      return this.formatDate(this.end as Date);\n    },\n    formattedValue: {\n      get() {\n        const { tempValue, range, mode, isOpen, startText, endText, global, value: outValue } = this;\n        const selectedDates = this.getDates(outValue);\n        const selectedFmtDates: string[] = selectedDates.map((d: Date) => this.formatDate(d));\n\n        if (tempValue) {\n          return tempValue;\n        }\n\n        const strMode: string = range ? 'range' : mode;\n        let value = '';\n\n        switch (strMode) {\n          case 'time':\n          case 'date':\n          case 'month':\n          case 'year':\n            value = selectedFmtDates.join('');\n            break;\n          case 'range':\n            if (isOpen) {\n              value = [startText, endText].join(global.rangeSeparator);\n            } else if (selectedFmtDates.length > 1) {\n              value = [selectedFmtDates[0], selectedFmtDates[1]].join(global.rangeSeparator);\n            }\n            break;\n        }\n\n        return value;\n      },\n      set(value: dayjs.ConfigType) {\n        const { min, dateFormat } = this;\n        if (value) {\n          if (String(value).length >= String(this.formatDate(min || new Date())).length && dayjs(value, dateFormat)) {\n            this.tempValue = '';\n            this.setDate(value, true);\n          } else {\n            this.tempValue = value;\n          }\n        }\n      },\n    },\n    rangeText: {\n      get() {\n        let range = this.startText;\n        if (this.range) {\n          range += ` ${this.global.rangeSeparator} ${this.endText}`;\n        }\n        return range;\n      },\n      set(value: any) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        if (this.value) {\n          this.setDate(value, false);\n        }\n      },\n    },\n    min() {\n      const disableDate: any = this.disableDate || {};\n      const { before } = disableDate;\n      return before ? new Date(before) : null;\n    },\n    max() {\n      const disableDate: any = this.disableDate || {};\n      const { after } = disableDate;\n      return after ? new Date(after) : null;\n    },\n    classes(): any {\n      return [\n        name,\n        CLASSNAMES.SIZE[this.size] || '',\n        {\n          [`${name}--month-picker`]: this.mode === 'year' || this.mode === 'month',\n          [`${prefix}-inline`]: this.inline || this.inlineView,\n        },\n      ];\n    },\n    pickerStyles() {\n      return {\n        [`${name}__container`]: true,\n        [`${name}--open`]: this.isOpen || this.inlineView,\n        [`${name}--calendar-inline-view`]: this.inlineView,\n        [`${name}--range`]: this.range,\n      };\n    },\n  },\n  mounted() {\n    this.attachDatePicker();\n  },\n  methods: {\n    handleTimePick(col: EPickerCols, time: number, index: number) {\n      if (!this.range || index === 0) {\n        const start = new Date(this.start);\n        start[`set${firstUpperCase(col)}s`](time);\n        this.start = start;\n        this.startTimeValue = dayjs(start);\n        this.dateClick(new Date(start));\n      } else {\n        const end = new Date(this.end);\n        end[`set${firstUpperCase(col)}s`](time);\n        this.end = end;\n        this.endTimeValue = dayjs(end);\n        this.dateClick(new Date(end));\n      }\n    },\n    attachDatePicker(): any {\n      const startDate: Date = new Date();\n      const endDate: Date = new Date();\n      this.dateFormat = this.format;\n      const start = new Date(startDate);\n      let end = new Date(endDate);\n      if (!this.range) {\n        // ignore endDate for not range DatePicker\n        end = new Date(startDate);\n      }\n      this.start = start;\n      this.end = end;\n      const val = this.value || this.defaultValue || '';\n      this.setDate(val, false);\n      if (this.inlineView) {\n        this.open();\n      }\n    },\n    /**\n     * Watch for value changed by date-picker itself and notify parent component\n     *\n     * @param event\n     */\n    onNativeInput(event?: any): void {\n      const val: any = event.target.value;\n      this.formattedValue = val;\n      const d1: any = this.parseDate(val);\n\n      if (d1 instanceof Date) {\n        const d2: string = this.formatDate(d1);\n        emitEvent(this, 'input', d2);\n      }\n    },\n    onNativeFocus(event?: MouseEvent): void {\n      if (!this.isOpen) {\n        this.open();\n      }\n      emitEvent(this, 'focus', event);\n    },\n    onClick(event?: MouseEvent): void {\n      if (!this.isOpen) {\n        this.open();\n      }\n      emitEvent(this, 'click', event);\n    },\n\n    normalizeDateTime(value: Date, oldValue: Date): Date {\n      const newDate = dayjs(value);\n      const oldDate = dayjs(oldValue);\n      if (this.enableTimePicker) {\n        newDate.hour(oldDate.hour());\n        newDate.minute(oldDate.minute());\n        newDate.second(oldDate.second());\n        newDate.millisecond(oldDate.millisecond());\n      }\n\n      return newDate.toDate();\n    },\n\n    dateClick(value: Date) {\n      // @todo add year range and month range\n      let mode = this.range ? 'range' : this.mode;\n\n      const start = this.start as Date;\n      const end = this.end as Date;\n\n      if (this.showTime) {\n        mode = 'time';\n      }\n\n      switch (mode) {\n        case 'time':\n          this.selectedDates = this.range ? [this.start, this.end] : [value];\n          this.clickedApply(false);\n          break;\n        case 'year':\n        case 'month':\n        case 'date':\n          this.start = this.normalizeDateTime(value, start);\n          this.selectedDates = [this.start];\n          // 有时间选择时，点击日期不关闭弹窗\n          this.clickedApply(!this.enableTimePicker);\n          break;\n        case 'range':\n          if (this.inSelection) {\n            this.inSelection = false;\n            this.start = this.normalizeDateTime(value[0], end);\n            this.end = this.normalizeDateTime(value[1], end);\n\n            if (this.end < this.start) {\n              this.inSelection = true;\n              this.start = this.normalizeDateTime(value[0], start);\n            }\n          } else {\n            this.start = this.normalizeDateTime(value[0], start);\n            this.end = this.normalizeDateTime(value[1], end);\n            this.inSelection = true;\n          }\n          // 有时间选择时，点击日期不关闭弹窗\n          this.clickedApply(!this.enableTimePicker);\n          break;\n        default:\n          break;\n      }\n    },\n    toggle() {\n      if (!this.disabled) {\n        if (this.isOpen) {\n          this.close();\n        } else {\n          this.open();\n        }\n      }\n    },\n    open() {\n      if (!this.disabled) {\n        const { formattedValue } = this;\n        // set default value;\n        if (formattedValue) {\n          this.setDate(formattedValue);\n        }\n        this.tempValue = '';\n        // open\n        this.isOpen = true;\n        nextTick().then(() => {\n          onOpenDebounce(this);\n          emitEvent(this, 'open', this.selectedDates);\n        });\n      }\n    },\n    close() {\n      if (!this.disabled) {\n        this.tempValue = '';\n        this.isOpen = false;\n        this.showTime = false;\n        emitEvent(this, 'close', this.selectedDates);\n      }\n    },\n    clickedApply(closePicker = true): void {\n      if (this.range) {\n        this.selectedDates = [this.start, this.end];\n      }\n\n      const selectedDates = this.selectedDates.map((d: Date) => {\n        const fd = this.formatDate(d);\n        return fd;\n      });\n      // submit formate date\n      this.submitInput(selectedDates, true);\n\n      if (closePicker) {\n        this.close();\n      }\n    },\n    toggleTime() {\n      this.timeValue = dayjs(this.start as Date);\n      this.endTimeValue = dayjs(this.end as Date);\n\n      this.showTime = !this.showTime;\n\n      this.$nextTick(() => {\n        const timePickerPanel = this.$refs.timePickerPanel as any;\n        timePickerPanel && timePickerPanel.panelColUpdate();\n      });\n    },\n\n    clickRange(value: DateValue) {\n      if (Array.isArray(value)) {\n        const [start, end] = value as dayjs.ConfigType[];\n        this.start = dayjs(start).toDate();\n        this.end = dayjs(end || start).toDate();\n        this.monthDate = dayjs(start).toDate();\n      } else {\n        this.start = dayjs(value).toDate();\n        this.end = dayjs(value).toDate();\n        this.monthDate = dayjs(value).toDate();\n      }\n      this.clickedApply();\n    },\n    clear(triggerChange = false): void {\n      // close picker\n      this.close();\n\n      // set value\n      if (!this.disabled) {\n        const selectedDates: any[] = [];\n        this.selectedDates = selectedDates;\n        this.formattedValue = '';\n        this.submitInput(selectedDates, triggerChange);\n      }\n    },\n    submitInput(selectedDates: any[], triggerChange = true) {\n      const { multiSeparator } = this;\n      const mode = this.range ? 'range' : this.mode;\n\n      switch (mode) {\n        case 'date':\n        case 'month':\n        case 'year':\n          // submit formate date\n          emitEvent(this, 'input', selectedDates.join(multiSeparator));\n          if (triggerChange) {\n            emitEvent(this, 'change', selectedDates.join(multiSeparator));\n          }\n          break;\n        case 'range':\n          // submit formate date\n          emitEvent(this, 'input', selectedDates);\n          if (triggerChange) {\n            emitEvent(this, 'change', selectedDates);\n          }\n          break;\n        default:\n          break;\n      }\n    },\n    parseDate(value: any = '', format = ''): Date | boolean {\n      if (value instanceof Date) {\n        return new Date(value);\n      }\n      if (format) {\n        const oDate: dayjs.Dayjs = dayjs(value, format);\n        if (oDate.isValid()) {\n          return new Date(oDate.toDate());\n        }\n        return false;\n      }\n\n      const d2: dayjs.Dayjs = dayjs(value);\n      if (d2.isValid()) {\n        return new Date(d2.toDate());\n      }\n      return false;\n    },\n    isEnabled(value: Date): boolean {\n      const { min, max, disableDate, dateFormat } = this;\n      if (!disableDate) {\n        return true;\n      }\n      // 值类型为 Function 则表示返回值为 true 的日期会被禁用\n      if (typeof disableDate === 'function') {\n        return !disableDate(value);\n      }\n\n      // 禁用日期，示例：['A', 'B'] 表示日期 A 和日期 B 会被禁用。\n      if (Array.isArray(disableDate)) {\n        let isIncludes = false;\n        const formatedDisabledDate = disableDate.map((item: string) => dayjs(item, dateFormat));\n        formatedDisabledDate.forEach((item) => {\n          if (item.isSame(dayjs(value))) {\n            isIncludes = true;\n          }\n        });\n        return !isIncludes;\n      }\n\n      // { before: 'A', after: 'B' } 表示在 A 之前和在 B 之后的日期都会被禁用。\n      if (max && min) {\n        const compareMin = dayjs(new Date(min)).startOf('day');\n        const compareMax = dayjs(new Date(max)).startOf('day');\n\n        // check min\n        return dayjs(value).isBetween(compareMin, compareMax, null, '[]');\n      }\n\n      // { from: 'A', to: 'B' } 表示在 A 到 B 之间的日期会被禁用。\n      const { from, to }: { from?: Date; to?: Date } = disableDate;\n      if (from && to) {\n        const compareMin = dayjs(new Date(from)).startOf('day');\n        const compareMax = dayjs(new Date(to)).startOf('day');\n\n        // check min\n        return !dayjs(value).isBetween(compareMin, compareMax, null, '[]');\n      }\n\n      return true;\n    },\n    setDate(inputDate: any = '', triggerChange = false): void {\n      if ((inputDate !== 0 && !inputDate) || (inputDate instanceof Array && inputDate.length === 0)) {\n        return this.clear(triggerChange);\n      }\n\n      const selectedDates = this.getDates(inputDate);\n\n      this.selectedDates = selectedDates;\n      if (selectedDates.length > 0) {\n        const [start, end] = selectedDates;\n        this.start = start;\n        this.end = end || start;\n      }\n    },\n    getDates(inputDate: any = ''): Date[] {\n      if ((inputDate !== 0 && !inputDate) || (inputDate instanceof Array && inputDate.length === 0)) {\n        return [];\n      }\n\n      const format = this.dateFormat || '';\n\n      let dates: any[] = [];\n      if (inputDate instanceof Array) {\n        dates = inputDate.map((d) => {\n          const d1 = this.parseDate(d, format);\n          return d1;\n        });\n      } else if (inputDate instanceof Date || typeof inputDate === 'number') {\n        dates = [this.parseDate(inputDate, format)];\n      } else if (typeof inputDate === 'string') {\n        const mode = this.range ? 'range' : this.mode;\n\n        switch (mode) {\n          case 'date':\n          case 'month':\n          case 'year':\n            dates = [this.parseDate(inputDate, format)];\n            break;\n\n          case 'range':\n            dates = inputDate.split(this.global.rangeSeparator || '-').map((d) => {\n              const d1 = this.parseDate(d, format);\n              return d1;\n            });\n\n            break;\n\n          default:\n            break;\n        }\n      }\n      const selectedDates = dates.filter((d) => {\n        const isEnable = d instanceof Date && this.isEnabled(d);\n        return isEnable;\n      });\n      selectedDates.sort((a, b) => a.getTime() - b.getTime());\n\n      return selectedDates;\n    },\n    formatDate(date: Date, format = ''): string {\n      let dateFormat = format || this.dateFormat || this.global.format;\n      const arrTime = ['H', 'h', 'm', 's'];\n      const hasTime = arrTime.some((f) => String(dateFormat).includes(f));\n      if (this.enableTimePicker && !hasTime) {\n        dateFormat = [dateFormat, 'HH:mm:ss'].join(' ');\n      }\n      const d1 = new Date(date);\n      return dayjs(d1).format(dateFormat);\n    },\n    createPopover() {\n      if (this.inlineView) {\n        return;\n      }\n      const nativeInput = this.$refs.native as ComponentPublicInstance;\n\n      const tip: HTMLElement = this.$refs.dropdownPopup as HTMLElement;\n      const refEl: Element = ((nativeInput && nativeInput.$el) || this.$el) as Element;\n\n      if (!tip || !refEl) {\n        return;\n      }\n\n      this.initClickAway(tip);\n    },\n    getPlaceholderText() {\n      const { placeholder, mode } = this;\n      let placeholderStr = placeholder || this.global?.placeholder?.[mode];\n      if (placeholder && Array.isArray(placeholder)) {\n        placeholderStr = placeholder.join(this.global.rangeSeparator);\n      }\n      return placeholderStr;\n    },\n  },\n  render() {\n    // props\n    const {\n      popupProps,\n      disabled,\n      clearable,\n      allowInput,\n      size,\n      inputProps,\n      enableTimePicker,\n      mode,\n      range,\n      presets,\n      firstDayOfWeek,\n    } = this;\n\n    // data\n    const { start, end, showTime, startTimeValue, global, isOpen, endTimeValue } = this;\n\n    const panelProps = {\n      value: range ? [start, end] : start,\n      mode,\n      firstDayOfWeek: firstDayOfWeek === undefined ? 1 : firstDayOfWeek,\n      disableDate: (d: Date) => !this.isEnabled(d),\n      onChange: this.dateClick,\n      global: this.global,\n    };\n\n    const onPick = (date: DateValue, context: PickContext) => {\n      emitEvent(this, 'pick', date, context);\n    };\n\n    const panelComponent = range ? <t-date-range {...{ ...panelProps, onPick }} /> : <t-date {...panelProps} />;\n\n    const popupContent = () => (\n      <div ref=\"dropdownPopup\" class={this.pickerStyles}>\n        {enableTimePicker && showTime && (\n          <div>\n            <TTimePickerPanel\n              ref=\"timePickerPanel\"\n              format={extractTimeFormat(this.dateFormat) || 'HH:mm:ss'}\n              cols={[EPickerCols.hour, EPickerCols.minute, EPickerCols.second]}\n              steps={[1, 1, 1]}\n              value={!range ? [startTimeValue] : [startTimeValue, endTimeValue]}\n              onTimePick={this.handleTimePick}\n              isShowPanel={showTime}\n              isFooterDisplay={false}\n            />\n          </div>\n        )}\n        {!showTime && panelComponent}\n        {(!!presets || enableTimePicker) && (\n          <div class={`${prefix}-date-picker__footer`}>\n            <TCalendarPresets presets={presets} global={global} onClick={range ? this.clickRange : this.dateClick} />\n            {enableTimePicker && (\n              <div class={`${name}--apply`}>\n                {enableTimePicker && (\n                  <t-button theme=\"primary\" variant=\"text\" onClick={this.toggleTime}>\n                    {showTime ? global.selectDate : global.selectTime}\n                  </t-button>\n                )}\n                {\n                  <t-button theme=\"primary\" onClick={this.clickedApply}>\n                    {global.confirm}\n                  </t-button>\n                }\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n    const inputClassNames = [\n      `${prefix}-form-controls`,\n      {\n        [CLASSNAMES.STATUS.active]: this.isOpen,\n      },\n    ];\n    const prefixIcon = renderTNodeJSX(this, 'prefixIcon');\n    const suffixIconSlot = renderTNodeJSX(this, 'suffixIcon');\n    const suffixIcon = () => {\n      if (suffixIconSlot) {\n        return suffixIconSlot;\n      }\n      if (enableTimePicker) {\n        return <TimeIcon />;\n      }\n      return <CalendarIcon />;\n    };\n    return (\n      <div class={this.classes}>\n        <t-popup\n          ref=\"popup\"\n          class={`${name}__popup-reference`}\n          trigger=\"click\"\n          placement=\"bottom-left\"\n          disabled={disabled}\n          showArrow={false}\n          visible={isOpen}\n          popupProps={popupProps}\n          overlayClassName={name}\n          content={popupContent}\n          expandAnimation={true}\n          onVisibleChange={(\n            visible: boolean,\n            context: {\n              trigger: string;\n            },\n          ) => {\n            if (context.trigger === 'document') {\n              this.toggle();\n            }\n          }}\n        >\n          <div class={inputClassNames} onClick={this.toggle}>\n            <t-input\n              ref=\"native\"\n              v-model={this.formattedValue}\n              disabled={disabled}\n              clearable={clearable}\n              placeholder={this.getPlaceholderText()}\n              readonly={!allowInput}\n              allowInput={allowInput ? 1 : 0}\n              size={size}\n              inputProps={inputProps}\n              onClear={(context: { e: MouseEvent }) => {\n                context.e.stopPropagation();\n                this.clear(true);\n              }}\n              focus={this.onNativeFocus}\n              input={this.onNativeInput}\n              click={this.onClick}\n              suffixIcon={suffixIcon}\n              prefixIcon={prefixIcon}\n            />\n          </div>\n        </t-popup>\n      </div>\n    );\n  },\n});\n"],"names":["e","i","module","define","amd","globalThis","self","dayjs_plugin_isBetween","this","t","prototype","isBetween","s","f","n","o","r","u","isAfter","isBefore","dayjs","extend","onOpenDebounce","debounce","vm","createPopover","name","prefix","defineComponent","mixins","getConfigReceiverMixins","components","TPopup","TButton","TInput","TCalendarPresets","TDate","TDateRange","TTimePickerPanel","props","emits","data","tempValue","monthDate","Date","start","end","selectedDates","inSelection","inline","dateFormat","multiSeparator","inlineView","showTime","isOpen","startTimeValue","endTimeValue","computed","startText","formatDate","endText","formattedValue","get","range","mode","global","outValue","value","getDates","selectedFmtDates","map","d","strMode","join","rangeSeparator","length","set","min","String","setDate","rangeText","disableDate","before","max","after","classes","CLASSNAMES","SIZE","size","pickerStyles","mounted","attachDatePicker","methods","handleTimePick","col","time","index","firstUpperCase","dateClick","startDate","endDate","format","val","defaultValue","open","onNativeInput","event","target","d1","parseDate","d2","emitEvent","onNativeFocus","onClick","normalizeDateTime","oldValue","newDate","oldDate","enableTimePicker","hour","minute","second","millisecond","toDate","clickedApply","toggle","disabled","close","nextTick","then","closePicker","fd","submitInput","toggleTime","timeValue","$nextTick","timePickerPanel","$refs","panelColUpdate","clickRange","Array","isArray","clear","triggerChange","oDate","isValid","isEnabled","isIncludes","formatedDisabledDate","item","forEach","isSame","compareMin","startOf","compareMax","from","to","inputDate","dates","split","filter","isEnable","sort","a","b","getTime","date","arrTime","hasTime","some","includes","nativeInput","tip","dropdownPopup","refEl","$el","initClickAway","getPlaceholderText","placeholder","placeholderStr","render","popupProps","clearable","allowInput","inputProps","presets","firstDayOfWeek","panelProps","onChange","onPick","context","panelComponent","popupContent","extractTimeFormat","EPickerCols","selectDate","selectTime","confirm","inputClassNames","STATUS","active","prefixIcon","renderTNodeJSX","suffixIconSlot","suffixIcon","visible","trigger","stopPropagation"],"mappings":"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"}