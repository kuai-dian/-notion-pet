{"version":3,"file":"messageList.js","sources":["../../src/message/messageList.tsx"],"sourcesContent":["import { defineComponent } from 'vue';\nimport { PLACEMENT_OFFSET } from './const';\nimport TMessage from './message';\nimport { prefix } from '../config';\nimport { MessageOptions } from './type';\n\nexport const DEFAULT_Z_INDEX = 6000;\n\nconst getUniqueId = (() => {\n  let id = 0;\n  return () => {\n    id += 1;\n    return id;\n  };\n})();\n\nexport const MessageList = defineComponent({\n  name: `${prefix}-message__list`,\n  components: { TMessage },\n  props: {\n    zIndex: {\n      type: Number,\n      default: 0,\n    },\n    placement: {\n      type: String,\n      default: '',\n    },\n  },\n  data() {\n    return {\n      list: [],\n      messageList: [],\n    };\n  },\n  computed: {\n    styles(): Record<string, string | number> {\n      return {\n        ...PLACEMENT_OFFSET[this.placement],\n        zIndex: this.zIndex !== DEFAULT_Z_INDEX ? this.zIndex : DEFAULT_Z_INDEX,\n      };\n    },\n  },\n  methods: {\n    add(msg: MessageOptions): number {\n      const mg = {\n        ...msg,\n        key: getUniqueId(),\n      };\n      this.list.push(mg);\n      return this.list.length - 1;\n    },\n    remove(index: number) {\n      this.list.splice(index, 1);\n    },\n    removeAll() {\n      this.list = [];\n    },\n    getOffset(val: string | number) {\n      if (!val) return;\n      return isNaN(Number(val)) ? val : `${val}px`;\n    },\n    msgStyles(item: { offset: Array<string | number> }) {\n      return (\n        item.offset && {\n          position: 'relative',\n          left: this.getOffset(item.offset[0]),\n          top: this.getOffset(item.offset[1]),\n        }\n      );\n    },\n    getListeners(index: number) {\n      return {\n        onClickCloseBtn: () => this.remove(index),\n        onDurationEnd: () => this.remove(index),\n      };\n    },\n    addChild(el: Element) {\n      if (el) {\n        this.messageList.push(el);\n      }\n    },\n  },\n  render() {\n    if (!this.list.length) return;\n    return (\n      <div class=\"t-message__list\" style={this.styles}>\n        {this.list.map((item, index) => (\n          <t-message\n            key={item.key}\n            style={this.msgStyles(item)}\n            ref={this.addChild}\n            {...item}\n            {...this.getListeners(index)}\n          />\n        ))}\n      </div>\n    );\n  },\n});\n\nexport default MessageList;\n"],"names":["DEFAULT_Z_INDEX","getUniqueId","id","MessageList","defineComponent","name","prefix","components","TMessage","props","zIndex","type","Number","placement","String","data","list","messageList","computed","styles","PLACEMENT_OFFSET","methods","add","msg","mg","key","push","length","remove","index","splice","removeAll","getOffset","val","isNaN","msgStyles","item","offset","position","left","top","getListeners","onClickCloseBtn","onDurationEnd","addChild","el","render","map"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAIaA,eAAe,GAAG;;AAC/B,IAAMC,WAAW,GAAI,YAAM;AACzB,MAAIC,EAAE,GAAG,CAAT;AACA,SAAO,YAAM;AACXA,IAAAA,EAAE,IAAI,CAAN;AACA,WAAOA,EAAP;AACD,GAHD;AAID,CANmB,EAApB;;IAOaC,WAAW,GAAGC,eAAe,CAAC;AACzCC,EAAAA,IAAI,YAAKC,MAAL,mBADqC;AAEzCC,EAAAA,UAAU,EAAE;AAAEC,IAAAA,QAAQ,EAARA;AAAF,GAF6B;AAGzCC,EAAAA,KAAK,EAAE;AACLC,IAAAA,MAAM,EAAE;AACNC,MAAAA,IAAI,EAAEC,MADA;AAEN,iBAAS;AAFH,KADH;AAKLC,IAAAA,SAAS,EAAE;AACTF,MAAAA,IAAI,EAAEG,MADG;AAET,iBAAS;AAFA;AALN,GAHkC;AAazCC,EAAAA,IAbyC,kBAalC;AACL,WAAO;AACLC,MAAAA,IAAI,EAAE,EADD;AAELC,MAAAA,WAAW,EAAE;AAFR,KAAP;AAID,GAlBwC;AAmBzCC,EAAAA,QAAQ,EAAE;AACRC,IAAAA,MADQ,oBACC;AACP,6CACKC,gBAAgB,CAAC,KAAKP,SAAN,CADrB;AAEEH,QAAAA,MAAM,EAAE,KAAKA,MAAL,KAAgBV,eAAhB,GAAkC,KAAKU,MAAvC,GAAgDV;AAF1D;AAID;AANO,GAnB+B;AA2BzCqB,EAAAA,OAAO,EAAE;AACPC,IAAAA,GADO,eACHC,GADG,EACE;AACP,UAAMC,EAAE,mCACHD,GADG;AAENE,QAAAA,GAAG,EAAExB,WAAW;AAFV,QAAR;;AAIA,WAAKe,IAAL,CAAUU,IAAV,CAAeF,EAAf;AACA,aAAO,KAAKR,IAAL,CAAUW,MAAV,GAAmB,CAA1B;AACD,KARM;AASPC,IAAAA,MATO,kBASAC,KATA,EASO;AACZ,WAAKb,IAAL,CAAUc,MAAV,CAAiBD,KAAjB,EAAwB,CAAxB;AACD,KAXM;AAYPE,IAAAA,SAZO,uBAYK;AACV,WAAKf,IAAL,GAAY,EAAZ;AACD,KAdM;AAePgB,IAAAA,SAfO,qBAeGC,GAfH,EAeQ;AACb,UAAI,CAACA,GAAL,EACE;AACF,aAAOC,KAAK,CAACtB,MAAM,CAACqB,GAAD,CAAP,CAAL,GAAqBA,GAArB,aAA8BA,GAA9B,OAAP;AACD,KAnBM;AAoBPE,IAAAA,SApBO,qBAoBGC,IApBH,EAoBS;AACd,aAAOA,IAAI,CAACC,MAAL,IAAe;AACpBC,QAAAA,QAAQ,EAAE,UADU;AAEpBC,QAAAA,IAAI,EAAE,KAAKP,SAAL,CAAeI,IAAI,CAACC,MAAL,CAAY,CAAZ,CAAf,CAFc;AAGpBG,QAAAA,GAAG,EAAE,KAAKR,SAAL,CAAeI,IAAI,CAACC,MAAL,CAAY,CAAZ,CAAf;AAHe,OAAtB;AAKD,KA1BM;AA2BPI,IAAAA,YA3BO,wBA2BMZ,KA3BN,EA2Ba;AAAA;;AAClB,aAAO;AACLa,QAAAA,eAAe,EAAE;AAAA,iBAAM,KAAI,CAACd,MAAL,CAAYC,KAAZ,CAAN;AAAA,SADZ;AAELc,QAAAA,aAAa,EAAE;AAAA,iBAAM,KAAI,CAACf,MAAL,CAAYC,KAAZ,CAAN;AAAA;AAFV,OAAP;AAID,KAhCM;AAiCPe,IAAAA,QAjCO,oBAiCEC,EAjCF,EAiCM;AACX,UAAIA,EAAJ,EAAQ;AACN,aAAK5B,WAAL,CAAiBS,IAAjB,CAAsBmB,EAAtB;AACD;AACF;AArCM,GA3BgC;AAkEzCC,EAAAA,MAlEyC,oBAkEhC;AAAA;;AACP,QAAI,CAAC,KAAK9B,IAAL,CAAUW,MAAf,EACE;AACF;AAAA,eAAkB,iBAAlB;AAAA,eAA2C,KAAKR;AAAhD,QAAyD,KAAKH,IAAL,CAAU+B,GAAV,CAAc,UAACX,IAAD,EAAOP,KAAP;AAAA;AAAA,eAAiCO,IAAI,CAACX,GAAtC;AAAA,iBAAkD,MAAI,CAACU,SAAL,CAAeC,IAAf,CAAlD;AAAA,eAA6E,MAAI,CAACQ;AAAlF,SAAgGR,IAAhG,EAA0G,MAAI,CAACK,YAAL,CAAkBZ,KAAlB,CAA1G;AAAA,KAAd,CAAzD;AACD;AAtEwC,CAAD;;;;"}