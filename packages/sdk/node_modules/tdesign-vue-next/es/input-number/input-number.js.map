{"version":3,"file":"input-number.js","sources":["../../src/input-number/input-number.tsx"],"sourcesContent":["import { defineComponent, VNode } from 'vue';\nimport { AddIcon, RemoveIcon, ChevronDownIcon, ChevronUpIcon } from 'tdesign-icons-vue-next';\nimport { prefix } from '../config';\nimport TButton from '../button';\nimport CLASSNAMES from '../utils/classnames';\nimport props from './props';\nimport { ChangeSource } from './type';\nimport { ClassName } from '../common';\nimport { emitEvent } from '../utils/event';\n\nconst name = `${prefix}-input-number`;\n\ntype InputNumberEvent = {\n  onInput?: (e: InputEvent) => void;\n  onClick?: (e: MouseEvent) => void;\n  onBlur?: (e: FocusEvent) => void;\n  onFocus?: (e: FocusEvent) => void;\n  onKeydown?: (e: KeyboardEvent) => void;\n  onKeyup?: (e: KeyboardEvent) => void;\n  onKeypress?: (e: KeyboardEvent) => void;\n};\n\ntype ChangeContextEvent = InputEvent | MouseEvent | FocusEvent;\n\ntype InputNumberAttr = {\n  disabled?: boolean;\n  readonly?: any;\n  autocomplete?: string;\n  ref: string;\n  placeholder: string;\n};\n\nexport default defineComponent({\n  name: 'TInputNumber',\n  components: {\n    AddIcon,\n    RemoveIcon,\n    ChevronDownIcon,\n    ChevronUpIcon,\n    TButton,\n  },\n  props: { ...props },\n  emits: ['update:value', 'change', 'blur', 'focus', 'keydown-enter', 'keydown', 'keyup', 'keypress'],\n  data() {\n    return {\n      userInput: null,\n      filterValue: null,\n      isError: false,\n      inputing: false,\n    };\n  },\n  computed: {\n    disabledReduce(): boolean {\n      return this.disabled || this.isError || Number(this.value) - this.step < this.min;\n    },\n    disabledAdd(): boolean {\n      return this.disabled || this.isError || Number(this.value) + this.step > this.max;\n    },\n    valueDecimalPlaces(): number {\n      const tempVal =\n        this.filterValue !== null &&\n        !Number.isNaN(Number(this.filterValue)) &&\n        !Number.isNaN(parseFloat(this.filterValue))\n          ? this.filterValue\n          : String(this.value);\n      const tempIndex = tempVal.indexOf('.') + 1;\n      return tempIndex > 0 ? tempVal.length - tempIndex : 0;\n    },\n    stepDecimalPlaces(): number {\n      const tempVal = String(this.step);\n      const tempIndex = tempVal.indexOf('.') + 1;\n      return tempIndex > 0 ? tempVal.length - tempIndex : 0;\n    },\n    digitsNum(): number {\n      if (this.decimalPlaces !== undefined) {\n        if (this.decimalPlaces < this.stepDecimalPlaces) {\n          console.warn('decimal places of step should be less than decimal-places');\n        }\n        return this.decimalPlaces;\n      }\n      return this.valueDecimalPlaces > this.stepDecimalPlaces ? this.valueDecimalPlaces : this.stepDecimalPlaces;\n    },\n    reduceClasses() {\n      return [\n        `${name}__decrease`,\n        {\n          [CLASSNAMES.STATUS.disabled]: this.disabledReduce,\n        },\n      ];\n    },\n    reduceEvents(): InputNumberEvent {\n      return {\n        onClick: this.handleReduce,\n      };\n    },\n    addClasses(): ClassName {\n      return [\n        `${name}__increase`,\n        {\n          [CLASSNAMES.STATUS.disabled]: this.disabledAdd,\n        },\n      ];\n    },\n    addEvents(): InputNumberEvent {\n      return {\n        onClick: this.handleAdd,\n      };\n    },\n    cmptWrapClasses(): ClassName {\n      return [\n        't-input-number',\n        CLASSNAMES.SIZE[this.size],\n        {\n          [CLASSNAMES.STATUS.disabled]: this.disabled,\n          't-is-controls-right': this.theme === 'column',\n          't-input-number--normal': this.theme === 'normal',\n        },\n      ];\n    },\n    inputWrapProps(): ClassName {\n      return [\n        't-input',\n        {\n          't-is-error': this.isError,\n          [`${prefix}-align-${this.align}`]: this.align,\n        },\n      ];\n    },\n    inputClasses(): ClassName {\n      return [\n        't-input__inner',\n        {\n          [CLASSNAMES.STATUS.disabled]: this.disabled,\n          [`${name}-text-align`]: this.theme === 'row',\n        },\n      ];\n    },\n    inputEvents(): InputNumberEvent {\n      return {\n        onInput: this.handleInput,\n        onBlur: this.handleBlur,\n        onFocus: this.handleFocus,\n        onKeydown: this.handleKeydown,\n        onKeyup: this.handleKeyup,\n        onKeypress: this.handleKeypress,\n      };\n    },\n    inputAttrs(): InputNumberAttr {\n      return {\n        disabled: this.disabled,\n        autocomplete: 'off',\n        ref: 'refInputElem',\n        placeholder: this.placeholder,\n      };\n    },\n    decreaseIcon(): VNode {\n      return this.theme === 'column' ? <chevron-down-icon size={this.size} /> : <remove-icon size={this.size} />;\n    },\n    increaseIcon(): VNode {\n      return this.theme === 'column' ? <chevron-up-icon size={this.size} /> : <add-icon size={this.size} />;\n    },\n    displayValue(): number | string {\n      // inputing\n      if (this.inputing && this.userInput !== null) {\n        return this.filterValue;\n      }\n      if ([undefined, null].includes(this.value)) return '';\n      // end input\n      return this.format && !this.inputing ? this.format(this.value) : this.value.toFixed(this.digitsNum);\n    },\n  },\n  watch: {\n    value: {\n      immediate: true,\n      handler(v) {\n        if (v !== undefined) {\n          this.isValidNumber(v);\n        }\n      },\n    },\n  },\n  methods: {\n    handleAdd(e: MouseEvent) {\n      if (this.disabledAdd) return;\n      const value = this.value || 0;\n      const factor = 10 ** this.digitsNum;\n      this.handleAction(\n        Number(this.toDecimalPlaces((value * factor + this.step * factor) / factor).toFixed(this.digitsNum)),\n        'add',\n        e,\n      );\n    },\n    handleReduce(e: MouseEvent) {\n      if (this.disabledReduce) return;\n      const value = this.value || 0;\n      const factor = 10 ** this.digitsNum;\n      this.handleAction(\n        Number(this.toDecimalPlaces((value * factor - this.step * factor) / factor).toFixed(this.digitsNum)),\n        'reduce',\n        e,\n      );\n    },\n    handleInput(e: InputEvent) {\n      // get\n      this.userInput = (e.target as HTMLInputElement).value;\n      // filter\n      this.filterValue = this.toValidStringNumber(this.userInput);\n      this.userInput = '';\n      // check\n      if (!this.isValid(this.filterValue) || Number(this.filterValue) === this.value) return;\n      // set\n      this.updateValue(Number(this.filterValue));\n      this.handleAction(Number(this.filterValue), 'input', e);\n    },\n    handleAction(value: number, actionType: ChangeSource, e: ChangeContextEvent) {\n      if (actionType !== 'input') {\n        this.clearInput();\n      }\n      this.handleChange(value, { type: actionType, e });\n    },\n    toValidStringNumber(s: string) {\n      // only allow one [.e] and two [-]\n      let filterVal = s.replace(/[^\\d.eE。-]/g, '').replace('。', '.');\n      if (this.multiE(filterVal) || this.multiDot(filterVal) || this.multiNegative(filterVal)) {\n        filterVal = filterVal.substr(0, filterVal.length - 1);\n      }\n      return filterVal;\n    },\n    toValidNumber(s: string) {\n      const val = Number(s);\n      if (Number.isNaN(val) || Number.isNaN(parseFloat(s))) return this.value;\n      if (val > this.max) return this.max;\n      if (val < this.min) return this.min;\n      return parseFloat(s);\n    },\n    handleChange(value: number, ctx: { type: ChangeSource; e: ChangeContextEvent }) {\n      this.updateValue(value);\n      emitEvent(this, 'change', value, { type: ctx.type, e: ctx.e });\n    },\n    async handleBlur(e: FocusEvent) {\n      await this.handleEndInput(e);\n      this.clearFilterValue();\n      emitEvent(this, 'blur', this.value, { e });\n    },\n    handleFocus(e: FocusEvent) {\n      this.handleStartInput();\n      emitEvent(this, 'focus', this.value, { e });\n    },\n    handleKeydownEnter(e: KeyboardEvent) {\n      if (e.key !== 'Enter') return;\n      emitEvent(this, 'keydown-enter', this.value, { e });\n    },\n    handleKeydown(e: KeyboardEvent) {\n      emitEvent(this, 'keydown', this.value, { e });\n      this.handleKeydownEnter(e);\n    },\n    handleKeyup(e: KeyboardEvent) {\n      emitEvent(this, 'keyup', this.value, { e });\n    },\n    handleKeypress(e: KeyboardEvent) {\n      emitEvent(this, 'keypress', this.value, { e });\n    },\n    handleStartInput() {\n      this.inputing = true;\n      if (this.value === undefined) return;\n      this.filterValue = this.value.toFixed(this.digitsNum);\n    },\n    handleEndInput(e: FocusEvent) {\n      this.inputing = false;\n      const value = this.toValidNumber(this.filterValue);\n      if (value !== this.value) {\n        this.updateValue(value);\n        this.handleAction(value, 'input', e);\n      }\n      this.isError = false;\n    },\n    updateValue(v: number) {\n      this.$emit('update:value', v);\n    },\n    handleInputError(visible: boolean) {\n      this.isError = visible;\n    },\n    isValid(v: string) {\n      const numV = Number(v);\n      if (this.empty(v) || Number.isNaN(numV)) {\n        this.handleInputError(true);\n        return false;\n      }\n      return this.isValidNumber(numV);\n    },\n    isValidNumber(v: number) {\n      if (v > this.max) {\n        this.handleInputError(true);\n        return false;\n      }\n      if (v < this.min) {\n        this.handleInputError(true);\n        return false;\n      }\n      this.handleInputError(false);\n      return true;\n    },\n    empty(v: string) {\n      return !v && !v.replace(' ', '');\n    },\n    clearInput() {\n      this.userInput = null;\n    },\n    clearFilterValue() {\n      this.filterValue = '';\n    },\n    multiE(s: string) {\n      const m = s.match(/[e]/gi);\n      return m === null ? false : m.length > 1;\n    },\n    multiDot(s: string) {\n      const m = s.match(/[.]/g);\n      return m === null ? false : m.length > 1;\n    },\n    multiNegative(s: string) {\n      const m = s.match(/[-]/g);\n      return m === null ? false : m.length > 2;\n    },\n    toDecimalPlaces(value: number): number {\n      const decimalPlaces = this.decimalPlaces === undefined ? this.digitsNum : this.decimalPlaces;\n      const factor = 10 ** decimalPlaces;\n      return Math.round(value * factor) / factor;\n    },\n  },\n  render() {\n    return (\n      <div class={this.cmptWrapClasses}>\n        {this.theme !== 'normal' && (\n          <t-button\n            class={this.reduceClasses}\n            {...this.reduceEvents}\n            variant=\"outline\"\n            shape=\"square\"\n            v-slots={{\n              icon: () => this.decreaseIcon,\n            }}\n          />\n        )}\n        <div class={this.inputWrapProps}>\n          <input value={this.displayValue} class={this.inputClasses} {...this.inputAttrs} {...this.inputEvents} />\n        </div>\n        {this.theme !== 'normal' && (\n          <t-button\n            class={this.addClasses}\n            {...this.addEvents}\n            variant=\"outline\"\n            shape=\"square\"\n            v-slots={{\n              icon: () => this.increaseIcon,\n            }}\n          />\n        )}\n      </div>\n    );\n  },\n});\n"],"names":["name","prefix","defineComponent","components","AddIcon","RemoveIcon","ChevronDownIcon","ChevronUpIcon","TButton","props","emits","data","userInput","filterValue","isError","inputing","computed","disabledReduce","disabled","Number","value","step","min","disabledAdd","max","valueDecimalPlaces","tempVal","isNaN","parseFloat","String","tempIndex","indexOf","length","stepDecimalPlaces","digitsNum","decimalPlaces","console","warn","reduceClasses","CLASSNAMES","STATUS","reduceEvents","onClick","handleReduce","addClasses","addEvents","handleAdd","cmptWrapClasses","SIZE","size","theme","inputWrapProps","align","inputClasses","inputEvents","onInput","handleInput","onBlur","handleBlur","onFocus","handleFocus","onKeydown","handleKeydown","onKeyup","handleKeyup","onKeypress","handleKeypress","inputAttrs","autocomplete","ref","placeholder","decreaseIcon","increaseIcon","displayValue","includes","format","toFixed","watch","immediate","handler","v","isValidNumber","methods","e","factor","handleAction","toDecimalPlaces","target","toValidStringNumber","isValid","updateValue","actionType","clearInput","handleChange","type","s","filterVal","replace","multiE","multiDot","multiNegative","substr","toValidNumber","val","ctx","emitEvent","handleEndInput","clearFilterValue","handleStartInput","handleKeydownEnter","key","$emit","handleInputError","visible","numV","empty","m","match","Math","round","render","icon"],"mappings":"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"}