{"version":3,"file":"config-receiver.js","sources":["../../src/config-provider/config-receiver.ts"],"sourcesContent":["import { defineComponent, PropType } from 'vue';\nimport defaultConfig from './zh_CN_config';\nimport { GlobalConfigProvider } from './type';\nimport { prefix } from '../config';\n\nexport type ValueOf<T> = T[keyof T];\n\nexport type ComponentConfigType = ValueOf<GlobalConfigProvider>;\n\nexport * from './type';\n\nexport type ConfigRule<T = any> = string | ((args: T) => string);\nexport interface Placement {\n  [propName: string]: string | number;\n}\n\nconst name = `${prefix}-locale-receiver`;\n\nexport default function getConfigReceiverMixins<C extends ComponentConfigType>(componentName: string) {\n  return defineComponent({\n    name,\n    inject: {\n      globalConfig: {\n        default: undefined,\n      },\n    },\n\n    computed: {\n      global(): C {\n        const defaultData = defaultConfig[componentName];\n        if (this.globalConfig && this.globalConfig[componentName]) {\n          return {\n            ...defaultData,\n            ...this.globalConfig[componentName],\n          };\n        }\n        return defaultData;\n      },\n    },\n\n    methods: {\n      t<T>(pattern: T, placement?: Placement): string {\n        if (typeof pattern === 'string') {\n          if (!placement) return pattern;\n          const regx = /\\{\\s*([\\w-]+)\\s*\\}/g;\n          const translated = pattern.replace(regx, (match, key) => {\n            if (placement) {\n              return String(placement[key]);\n            }\n            return '';\n          });\n          return translated;\n        }\n        if (typeof pattern === 'function') {\n          return pattern(placement);\n        }\n        return '';\n      },\n    },\n  });\n}\n"],"names":["name","prefix","getConfigReceiverMixins","componentName","defineComponent","inject","globalConfig","computed","global","defaultData","defaultConfig","methods","t","pattern","placement","regx","translated","replace","match","key","String"],"mappings":";;;;;;;;;;;;;;;AAIA,IAAMA,IAAI,aAAMC,MAAN,qBAAV;AACe,SAASC,uBAAT,CAAiCC,aAAjC,EAAgD;AAC7D,SAAOC,eAAe,CAAC;AACrBJ,IAAAA,IAAI,EAAJA,IADqB;AAErBK,IAAAA,MAAM,EAAE;AACNC,MAAAA,YAAY,EAAE;AACZ,mBAAS,KAAK;AADF;AADR,KAFa;AAOrBC,IAAAA,QAAQ,EAAE;AACRC,MAAAA,MADQ,oBACC;AACP,YAAMC,WAAW,GAAGC,gBAAa,CAACP,aAAD,CAAjC;;AACA,YAAI,KAAKG,YAAL,IAAqB,KAAKA,YAAL,CAAkBH,aAAlB,CAAzB,EAA2D;AACzD,iDACKM,WADL,GAEK,KAAKH,YAAL,CAAkBH,aAAlB,CAFL;AAID;;AACD,eAAOM,WAAP;AACD;AAVO,KAPW;AAmBrBE,IAAAA,OAAO,EAAE;AACPC,MAAAA,CADO,aACLC,OADK,EACIC,SADJ,EACe;AACpB,YAAI,OAAOD,OAAP,KAAmB,QAAvB,EAAiC;AAC/B,cAAI,CAACC,SAAL,EACE,OAAOD,OAAP;AACF,cAAME,IAAI,GAAG,qBAAb;AACA,cAAMC,UAAU,GAAGH,OAAO,CAACI,OAAR,CAAgBF,IAAhB,EAAsB,UAACG,KAAD,EAAQC,GAAR,EAAgB;AACvD,gBAAIL,SAAJ,EAAe;AACb,qBAAOM,MAAM,CAACN,SAAS,CAACK,GAAD,CAAV,CAAb;AACD;;AACD,mBAAO,EAAP;AACD,WALkB,CAAnB;AAMA,iBAAOH,UAAP;AACD;;AACD,YAAI,OAAOH,OAAP,KAAmB,UAAvB,EAAmC;AACjC,iBAAOA,OAAO,CAACC,SAAD,CAAd;AACD;;AACD,eAAO,EAAP;AACD;AAlBM;AAnBY,GAAD,CAAtB;AAwCD;;;;"}